// ==UserScript==
// @name         ReadIt
// @namespace    http://github.com/tralwdwd/
// @version      1.0.0
// @description  A userscript for Reddit Web with plugin support.
// @author       tralwdwd
// @match        https://*.reddit.com/*
// @icon         https://www.redditstatic.com/desktop2x/img/favicon/apple-icon-76x76.png
// @grant        GM.xmlHttpRequest
// @grant        unsafeWindow
// @grant        GM.getValue
// @grant        GM.setValue
// ==/UserScript==

// This code has been bundled, for source code go to https://github.com/readit-mod/readit


(function(){"use strict";class Ye{constructor(t){this.readit=t,this.selector="shreddit-post, shreddit-ad-post",this.postCallbacks=[],this._queuedPosts=new Set,this._rafScheduled=!1,this.registerOnPostsLoaded=s=>{this.postCallbacks.push(s),this._callbackInitialScan()},new MutationObserver(s=>{for(const o of s)for(const r of Array.from(o.addedNodes))r.nodeType===1&&r instanceof HTMLElement&&(r.matches(this.selector)&&this._queuedPosts.add(r),r.querySelectorAll(this.selector).forEach(n=>this._queuedPosts.add(n)));this._scheduleEmit()}).observe(document.body,{childList:!0,subtree:!0})}_callbackInitialScan(){const t=document.querySelectorAll(this.selector);t.length>0&&this._emitPosts(Array.from(t))}_scheduleEmit(){this._rafScheduled||(this._rafScheduled=!0,window.requestAnimationFrame(()=>{this._queuedPosts.size>0&&(this._emitPosts(Array.from(this._queuedPosts)),this._queuedPosts.clear()),this._rafScheduled=!1}))}_emitPosts(t){this.postCallbacks.forEach(i=>i(t))}}const Ke=(e=>e)({name:"ReadIt Adblock",description:"Builtin plugin to remove ads from the website.",id:"readit-adblock",version:"1.0.0",onLoad:async e=>{let t=await e.storage.get("ads-blocked",0);e.posts.registerLoadCallback(async i=>{i.forEach(s=>{s.matches("shreddit-ad-post")&&(t++,s.remove())}),await e.storage.set("ads-blocked",t)}),e.settings.registerSettingsTile({title:"Ads Blocked",description:`Total ads blocked: ${t}`})}}),Qe=Object.freeze(Object.defineProperty({__proto__:null,default:Ke},Symbol.toStringTag,{value:"Module"}));async function et(e){const t=await new Promise((o,r)=>{GM.xmlHttpRequest({method:"GET",url:e,onload:c=>o(c.responseText),onerror:c=>r(c)})}),i=new Blob([t],{type:"text/javascript"}),s=URL.createObjectURL(i);try{return await import(s)}finally{URL.revokeObjectURL(s)}}function tt(e){return{registerLoadCallback:t=>e.registerOnPostsLoaded(t)}}function nt(e){return{registerSettingsTile:t=>e.registerSettingsTile(t)}}function rt(e,t){return{async get(i,s){return await e.get(`plugin:${t}`,i,s)},async set(i,s){return await e.set(`plugin:${t}`,i,s)},async delete(i){return await e.delete(`plugin:${t}`,i)},async keys(){return await e.keys(`plugin:${t}`)}}}function ge(e,t){return{posts:tt(e.posts),settings:nt(e.settings),storage:rt(e.storage,t)}}class st{constructor(t){this.readit=t,this.unloadedPluginList=[],this.loadedPluginList=[],localStorage.getItem("plugins")==null&&localStorage.setItem("plugins","[]");const i=JSON.parse(localStorage.getItem("plugins"));this.unloadedPluginList=i}get pluginList(){return this.loadedPluginList}async loadPlugins(){console.log(this.unloadedPluginList),await this.loadBuiltins(),this.unloadedPluginList.forEach(async t=>{try{await this.loadPlugin(t.url)}catch(i){console.error("Plugin execution failed, URL:",t.url,i)}})}async loadBuiltins(){const t=Object.assign({"./builtin/ReadItAdBlock/index.ts":Qe});for(const i of Object.values(t)){const s=i.default,o=ge(this.readit,s.id);this.loadedPluginList.push(s),await s.onLoad(o)}}async loadPlugin(t){try{const s=(await et(t)).default;this.loadedPluginList.push(s);const o=ge(this.readit,s.id);await s.onLoad(o)}catch(i){console.error("Failed to load plugin:",i)}}addPlugin(t){localStorage.getItem("plugins")==null&&localStorage.setItem("plugins","[]");const i=JSON.parse(localStorage.getItem("plugins"));i.push({url:t}),localStorage.setItem("plugins",JSON.stringify(i)),alert("New Plugins require a reload!")}}const N=()=>typeof _nano<"u"&&_nano.isSSR===!0,it=Promise.prototype.then.bind(Promise.resolve()),ot=e=>{let t=0;for(let i=0;i<e.length;i++){const s=e.charCodeAt(i);t=(t<<5)-t+s,t|=0}return Math.abs(t).toString(32)},se=(e,t,i=!0)=>{if(!Array.isArray(t)){se(e,[t],i);return}typeof t=="object"&&(t=Array.prototype.slice.call(t)),t.forEach(s=>{if(Array.isArray(s))se(e,s,i);else{const o=k(s);typeof o<"u"&&(Array.isArray(o)?se(e,o,i):N()&&!i?e.appendChild(o.nodeType==null?o.toString():o):e.appendChild(o.nodeType==null?document.createTextNode(o.toString()):o))}})},at=e=>{const t=e.children[0],i=t.attributes;if(N())return t;const s=me("svg");for(let o=i.length-1;o>=0;o--)s.setAttribute(i[o].name,i[o].value);return s.innerHTML=t.innerHTML,s},k=e=>{if(e===null||e===!1||typeof e>"u")return[];if(typeof e=="string"||typeof e=="number")return e.toString();if(e.tagName&&e.tagName.toLowerCase()==="svg")return at({children:[e]});if(e.tagName||e&&e.nodeType===3)return e;if(e&&e.component&&e.component.isClass)return _e(e);if(e.isClass)return _e({component:e,props:{}});if(e.component&&typeof e.component=="function")return lt(e);if(Array.isArray(e))return e.map(t=>k(t)).flat();if(typeof e=="function"&&!e.isClass)return k(e());if(e.component&&e.component.tagName&&typeof e.component.tagName=="string"||Array.isArray(e.component)||e.component)return k(e.component);if(typeof e=="object")return[];console.warn("Something unexpected happened with:",e)},lt=e=>{const{component:t,props:i}=e;return k(t(i))},_e=e=>{const{component:t,props:i}=e,s=ot(t.toString());t.prototype._getHash=()=>s;const o=new t(i);N()||o.willMount();let r=o.render();return r=k(r),o.elements=r,i&&i.ref&&i.ref(o),N()||it(()=>{o._didMount()}),r},me=e=>document.createElementNS("http://www.w3.org/2000/svg",e),ct=(e,t={},...i)=>{if(t&&t.children&&(Array.isArray(i)?Array.isArray(t.children)?i=[...t.children,...i]:i.push(t.children):Array.isArray(t.children)?i=t.children:i=[t.children]),N()&&_nano.ssrTricks.isWebComponent(e)){const n=_nano.ssrTricks.renderWebComponent(e,t,i,k);return n===null?`ERROR: "<${e} />"`:n}if(typeof e!="string")return{component:e,props:Object.assign(Object.assign({},t),{children:i})};try{if(N()&&typeof e=="string"&&!document)throw new Error("document is not defined")}catch(n){console.log("ERROR:",n.message,`
 > Please read: https://github.com/nanojsx/nano/issues/106`)}let s;const o=e==="svg"?me("svg"):document.createElement(e),r=(n,u)=>u.indexOf("on")!==0?!1:n._ssr?!0:typeof n[u]=="object"||typeof n[u]=="function";for(const n in t){if(n==="style"&&typeof t[n]=="object"){const u=Object.keys(t[n]).map(l=>`${l}:${t[n][l]}`).join(";").replace(/[A-Z]/g,l=>`-${l.toLowerCase()}`);t[n]=`${u};`}if(n==="ref")s=t[n];else if(r(o,n.toLowerCase()))o.addEventListener(n.toLowerCase().substring(2),u=>t[n](u));else if(n==="dangerouslySetInnerHTML"&&t[n].__html)if(N())o.innerHTML=t[n].__html;else{const u=document.createElement("fragment");u.innerHTML=t[n].__html,o.appendChild(u)}else if(n==="innerHTML"&&t[n].__dangerousHtml)if(N())o.innerHTML=t[n].__dangerousHtml;else{const u=document.createElement("fragment");u.innerHTML=t[n].__dangerousHtml,o.appendChild(u)}else/^className$/i.test(n)?o.setAttribute("class",t[n]):typeof t[n]<"u"&&o.setAttribute(n,t[n])}const c=!["noscript","script","style"].includes(e);return se(o,i,c),s&&s(o),o};var ut=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(i[s[o]]=e[s[o]]);return i};const C=function(e,t){let{children:i=[]}=t,s=ut(t,["children"]);return Array.isArray(i)||(i=[i]),ct(e,s,...i)};function dt(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var D={},ae={},ye;function T(){return ye||(ye=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.h=e._render=e.hydrate=e.render=e.appendChildren=e.strToHash=e.removeAllChildNodes=e.tick=e.isSSR=void 0;const t=()=>typeof _nano<"u"&&_nano.isSSR===!0;e.isSSR=t,e.tick=Promise.prototype.then.bind(Promise.resolve());const i=a=>{for(;a.firstChild;)a.removeChild(a.firstChild)};e.removeAllChildNodes=i;const s=a=>{let d=0;for(let m=0;m<a.length;m++){const p=a.charCodeAt(m);d=(d<<5)-d+p,d|=0}return Math.abs(d).toString(32)};e.strToHash=s;const o=(a,d,m=!0)=>{if(!Array.isArray(d)){(0,e.appendChildren)(a,[d],m);return}typeof d=="object"&&(d=Array.prototype.slice.call(d)),d.forEach(p=>{if(Array.isArray(p))(0,e.appendChildren)(a,p,m);else{const b=(0,e._render)(p);typeof b<"u"&&(Array.isArray(b)?(0,e.appendChildren)(a,b,m):(0,e.isSSR)()&&!m?a.appendChild(b.nodeType==null?b.toString():b):a.appendChild(b.nodeType==null?document.createTextNode(b.toString()):b))}})};e.appendChildren=o;const r=a=>{const d=a.children[0],m=d.attributes;if((0,e.isSSR)())return d;const p=f("svg");for(let b=m.length-1;b>=0;b--)p.setAttribute(m[b].name,m[b].value);return p.innerHTML=d.innerHTML,p},c=(a,d=null,m=!0)=>{let p=(0,e._render)(a);return Array.isArray(p)&&(p=p.map(b=>(0,e._render)(b)),p.length===1&&(p=p[0])),d?(m&&(0,e.removeAllChildNodes)(d),p&&d.id&&d.id===p.id&&d.parentElement?d.parentElement.replaceChild(p,d):Array.isArray(p)?p.forEach(b=>{(0,e.appendChildren)(d,(0,e._render)(b))}):(0,e.appendChildren)(d,(0,e._render)(p)),d):(0,e.isSSR)()&&!Array.isArray(p)?[p]:p};e.render=c,e.hydrate=e.render;const n=a=>{if(a===null||a===!1||typeof a>"u")return[];if(typeof a=="string"||typeof a=="number")return a.toString();if(a.tagName&&a.tagName.toLowerCase()==="svg")return r({children:[a]});if(a.tagName||a&&a.nodeType===3)return a;if(a&&a.component&&a.component.isClass)return l(a);if(a.isClass)return l({component:a,props:{}});if(a.component&&typeof a.component=="function")return u(a);if(Array.isArray(a))return a.map(d=>(0,e._render)(d)).flat();if(typeof a=="function"&&!a.isClass)return(0,e._render)(a());if(a.component&&a.component.tagName&&typeof a.component.tagName=="string"||Array.isArray(a.component)||a.component)return(0,e._render)(a.component);if(typeof a=="object")return[];console.warn("Something unexpected happened with:",a)};e._render=n;const u=a=>{const{component:d,props:m}=a;return(0,e._render)(d(m))},l=a=>{const{component:d,props:m}=a,p=(0,e.strToHash)(d.toString());d.prototype._getHash=()=>p;const b=new d(m);(0,e.isSSR)()||b.willMount();let E=b.render();return E=(0,e._render)(E),b.elements=E,m&&m.ref&&m.ref(b),(0,e.isSSR)()||(0,e.tick)(()=>{b._didMount()}),E},f=a=>document.createElementNS("http://www.w3.org/2000/svg",a),y=(a,d={},...m)=>{if(d&&d.children&&(Array.isArray(m)?Array.isArray(d.children)?m=[...d.children,...m]:m.push(d.children):Array.isArray(d.children)?m=d.children:m=[d.children]),(0,e.isSSR)()&&_nano.ssrTricks.isWebComponent(a)){const h=_nano.ssrTricks.renderWebComponent(a,d,m,e._render);return h===null?`ERROR: "<${a} />"`:h}if(typeof a!="string")return{component:a,props:Object.assign(Object.assign({},d),{children:m})};try{if((0,e.isSSR)()&&typeof a=="string"&&!document)throw new Error("document is not defined")}catch(h){console.log("ERROR:",h.message,`
 > Please read: https://github.com/nanojsx/nano/issues/106`)}let p;const b=a==="svg"?f("svg"):document.createElement(a),E=(h,g)=>g.indexOf("on")!==0?!1:h._ssr?!0:typeof h[g]=="object"||typeof h[g]=="function";for(const h in d){if(h==="style"&&typeof d[h]=="object"){const g=Object.keys(d[h]).map(S=>`${S}:${d[h][S]}`).join(";").replace(/[A-Z]/g,S=>`-${S.toLowerCase()}`);d[h]=`${g};`}if(h==="ref")p=d[h];else if(E(b,h.toLowerCase()))b.addEventListener(h.toLowerCase().substring(2),g=>d[h](g));else if(h==="dangerouslySetInnerHTML"&&d[h].__html)if((0,e.isSSR)())b.innerHTML=d[h].__html;else{const g=document.createElement("fragment");g.innerHTML=d[h].__html,b.appendChild(g)}else if(h==="innerHTML"&&d[h].__dangerousHtml)if((0,e.isSSR)())b.innerHTML=d[h].__dangerousHtml;else{const g=document.createElement("fragment");g.innerHTML=d[h].__dangerousHtml,b.appendChild(g)}else/^className$/i.test(h)?b.setAttribute("class",d[h]):typeof d[h]<"u"&&b.setAttribute(h,d[h])}const P=!["noscript","script","style"].includes(a);return(0,e.appendChildren)(b,m,P),p&&p(b),b};e.h=y})(ae)),ae}var J={},A={},W={},be;function ve(){return be||(be=1,Object.defineProperty(W,"__esModule",{value:!0}),W.VERSION=void 0,W.VERSION="0.1.0"),W}var Se;function Z(){if(Se)return A;Se=1,Object.defineProperty(A,"__esModule",{value:!0}),A.printVersion=A.escapeHtml=A.onNodeRemove=A.detectSSR=A.nodeToString=A.task=void 0;const e=ve(),t=u=>setTimeout(u,0);A.task=t;const i=u=>{const l=document.createElement("div");return l.appendChild(u.cloneNode(!0)),l.innerHTML};A.nodeToString=i;const s=()=>{const u=typeof Deno<"u",l=typeof window<"u";return typeof _nano<"u"&&_nano.isSSR||u||!l};A.detectSSR=s;function o(u,l){return!!u&&(u===l||o(u.parentNode,l))}const r=(u,l)=>{let f=new MutationObserver(y=>{y.forEach(a=>{a.removedNodes.forEach(d=>{o(u,d)&&(l(),f&&(f.disconnect(),f=void 0))})})});return f.observe(document,{childList:!0,subtree:!0}),f};A.onNodeRemove=r;const c=u=>u&&typeof u=="string"?u.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):u;A.escapeHtml=c;const n=()=>{const u=`Powered by nano JSX v${e.VERSION}`;console.log(`%c %c %c %c %c ${u} %c http://nanojsx.io`,"background: #ff0000","background: #ffff00","background: #00ff00","background: #00ffff","color: #fff; background: #000000;","background: none")};return A.printVersion=n,A}var le={},je;function we(){return je||(je=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e._clearState=e._state=void 0,e._state=new Map;const t=()=>{e._state.clear()};e._clearState=t})(le)),le}var Oe;function $(){if(Oe)return J;Oe=1,Object.defineProperty(J,"__esModule",{value:!0}),J.Component=void 0;const e=Z(),t=T(),i=we();class s{constructor(r){this._elements=[],this._skipUnmount=!1,this._hasUnmounted=!1,this.props=r||{},this.id=this._getHash()}static get isClass(){return!0}get isClass(){return!0}setState(r,c=!1){typeof r=="object"&&r!==null&&this.state!==void 0?this.state=Object.assign(Object.assign({},this.state),r):this.state=r,c&&this.update()}set state(r){i._state.set(this.id,r)}get state(){return i._state.get(this.id)}set initState(r){this.state===void 0&&(this.state=r)}get elements(){return this._elements||[]}set elements(r){Array.isArray(r)||(r=[r]),r.forEach(c=>{this._elements.push(c)})}_addNodeRemoveListener(){/^[^{]+{\s+}$/gm.test(this.didUnmount.toString())||(0,e.onNodeRemove)(this.elements[0],()=>{this._skipUnmount||this._didUnmount()})}_didMount(){this._addNodeRemoveListener(),this.didMount()}_willUpdate(){this.willUpdate()}_didUpdate(){this.didUpdate()}_didUnmount(){this._hasUnmounted||(this.didUnmount(),this._hasUnmounted=!0)}willMount(){}didMount(){}willUpdate(){}didUpdate(){}didUnmount(){}render(r){}update(r){this._skipUnmount=!0,this._willUpdate();const c=[...this.elements];this._elements=[];let n=this.render(r);n=(0,t._render)(n),this.elements=n;const u=c[0].parentElement;u||console.warn("Component needs a parent element to get updated!"),this.elements.forEach(l=>{u&&u.insertBefore(l,c[0])}),c.forEach(l=>{this.elements.includes(l)||(l.remove(),l=null)}),this._addNodeRemoveListener(),(0,t.tick)(()=>{this._skipUnmount=!1,this.elements[0].isConnected?this._didUpdate():this._didUnmount()})}_getHash(){}}return J.Component=s,J}var q={},X={},Pe;function ce(){if(Pe)return X;Pe=1,Object.defineProperty(X,"__esModule",{value:!0}),X.Helmet=void 0;const e=$(),t=T();class i extends Map{toString(){let r="";for(const[c,n]of this)r+=` ${c}="${n}"`;return r.trim()}}class s extends e.Component{static SSR(r){var c,n;const u=/(<helmet\b[^>]*>)((.|\r|\n)*?)(<\/helmet>)/gm,l=[],f=[],y={html:new i,body:new i};if(typeof document<"u"&&document.head){let m=[];m=[].slice.call(document.head.children);for(let p=0;p<m.length;p++)l.indexOf(m[p])===-1&&l.push(m[p])}let a;for(;(a=u.exec(r))!==null;){const m=a[1];let p=a[2];const b=/<html\s([^>]+)><\/html>/gm,E=/<body\s([^>]+)><\/body>/gm,P=/(\w+)="([^"]+)"/gm;let h=null;(c=r.match(b))===null||c===void 0||c.forEach(S=>{for(p=p.replace(S,"");(h=P.exec(S))!==null;)y.html.set(h[1],h[2])}),(n=r.match(E))===null||n===void 0||n.forEach(S=>{for(p=p.replace(S,"");(h=P.exec(S))!==null;)y.body.set(h[1],h[2])});const g=m.includes('data-placement="head"');g&&!l.includes(p)?l.push(p):!g&&!f.includes(p)&&f.push(p)}return{body:r.replace(u,""),head:l,footer:f,attributes:y}}didMount(){this.props.children.forEach(r=>{var c,n,u,l;if(!(r instanceof HTMLElement))return;const f=this.props.footer?document.body:document.head,y=r.tagName;let a=[];a.push(r.innerText);for(let p=0;p<r.attributes.length;p++)a.push((c=r.attributes.item(p))===null||c===void 0?void 0:c.name.toLowerCase()),a.push((n=r.attributes.item(p))===null||n===void 0?void 0:n.value.toLowerCase());if(y==="HTML"||y==="BODY"){const p=document.getElementsByTagName(y)[0];for(let b=1;b<a.length;b+=2)p.setAttribute(a[b],a[b+1]);return}else if(y==="TITLE"){const p=document.getElementsByTagName("TITLE");if(p.length>0){const b=r;p[0].text=b.text}else{const b=(0,t.h)("title",null,r.innerHTML);(0,t.appendChildren)(f,[b],!1)}return}let d=!1;a=a.sort();const m=document.getElementsByTagName(y);for(let p=0;p<m.length;p++){let b=[];b.push(m[p].innerText);for(let E=0;E<m[p].attributes.length;E++)b.push((u=m[p].attributes.item(E))===null||u===void 0?void 0:u.name.toLowerCase()),b.push((l=m[p].attributes.item(E))===null||l===void 0?void 0:l.value.toLowerCase());b=b.sort(),a.length>0&&b.length>0&&JSON.stringify(a)===JSON.stringify(b)&&(d=!0)}d||(0,t.appendChildren)(f,[r],!1)})}render(){const r=this.props.footer?"footer":"head";return(0,t.isSSR)()?(0,t.h)("helmet",{"data-ssr":!0,"data-placement":r},this.props.children):[]}}return X.Helmet=s,X}var V={},Ce;function ht(){if(Ce)return V;Ce=1;var e=V&&V.__rest||function(o,r){var c={};for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&r.indexOf(n)<0&&(c[n]=o[n]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,n=Object.getOwnPropertySymbols(o);u<n.length;u++)r.indexOf(n[u])<0&&Object.prototype.propertyIsEnumerable.call(o,n[u])&&(c[n[u]]=o[n[u]]);return c};Object.defineProperty(V,"__esModule",{value:!0}),V.Img=void 0;const t=$(),i=T();class s extends t.Component{constructor(r){super(r);const{src:c,key:n}=r;this.id=`${(0,i.strToHash)(c)}-${(0,i.strToHash)(JSON.stringify(r))}`,n&&(this.id+=`key-${n}`),this.state||this.setState({isLoaded:!1,image:void 0})}didMount(){const r=this.props,{lazy:c=!0,placeholder:n,children:u,key:l,ref:f}=r,y=e(r,["lazy","placeholder","children","key","ref"]);if(typeof c=="boolean"&&c===!1)return;new IntersectionObserver((d,m)=>{d.forEach(p=>{p.isIntersecting&&(m.disconnect(),this.state.image=(0,i.h)("img",Object.assign({},y)),this.state.image.complete?(this.state.isLoaded=!0,this.update()):this.state.image.onload=()=>{this.state.isLoaded=!0,this.update()})})},{threshold:[0,1]}).observe(this.elements[0])}render(){const r=this.props,{src:c,placeholder:n,children:u,lazy:l=!0,key:f,ref:y}=r,a=e(r,["src","placeholder","children","lazy","key","ref"]);if(typeof l=="boolean"&&l===!1)return this.state.image=(0,i.h)("img",Object.assign({src:c},a)),this.state.image;if(this.state.isLoaded)return this.state.image;if(n&&typeof n=="string")return(0,i.h)("img",Object.assign({src:n},a));if(n&&typeof n=="function")return n();{const d={};a.width&&(d.width=`${a.width}px`),a.height&&(d.height=`${a.height}px`);const{width:m,height:p}=a,b=e(a,["width","height"]);return(0,i.h)("div",Object.assign({style:d},b))}}}return V.Img=s,V}var U={},Y={},Re;function ue(){if(Re)return Y;Re=1,Object.defineProperty(Y,"__esModule",{value:!0}),Y.Fragment=void 0;const e=t=>t.children;return Y.Fragment=e,Y}var Ee;function ft(){if(Ee)return U;Ee=1;var e=U&&U.__rest||function(c,n){var u={};for(var l in c)Object.prototype.hasOwnProperty.call(c,l)&&n.indexOf(l)<0&&(u[l]=c[l]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,l=Object.getOwnPropertySymbols(c);f<l.length;f++)n.indexOf(l[f])<0&&Object.prototype.propertyIsEnumerable.call(c,l[f])&&(u[l[f]]=c[l[f]]);return u};Object.defineProperty(U,"__esModule",{value:!0}),U.Link=void 0;const t=$(),i=ce(),s=T(),o=ue();class r extends t.Component{prefetchOnHover(){this.elements[0].addEventListener("mouseover",()=>this.addPrefetch(),{once:!0})}prefetchOnVisible(){new IntersectionObserver((u,l)=>{u.forEach(f=>{f.isIntersecting&&(l.disconnect(),this.addPrefetch())})},{threshold:[0,1]}).observe(this.elements[0])}addPrefetch(){let n=!1;const u=document.getElementsByTagName("link");for(let l=0;l<u.length;l++)u[l].getAttribute("rel")==="prefetch"&&u[l].getAttribute("href")===this.props.href&&(n=!0);if(!n){const l=(0,s.h)("link",{rel:"prefetch",href:this.props.href,as:"document"});document.head.appendChild(l)}}didMount(){const{href:n,prefetch:u,delay:l=0,back:f=!1}=this.props;f&&this.elements[0].addEventListener("click",y=>{y.preventDefault();const a=y.target;a.href===document.referrer?window.history.back():window.location.href=a.href}),l>0&&this.elements[0].addEventListener("click",y=>{y.preventDefault(),setTimeout(()=>window.location.href=n,l)}),u&&(u==="hover"?this.prefetchOnHover():u==="visible"?this.prefetchOnVisible():this.addPrefetch())}render(){const n=this.props,{children:u,prefetch:l,back:f,ref:y}=n,a=e(n,["children","prefetch","back","ref"]);this.props.href||console.warn('Please add "href" to <Link>'),u.length!==1&&console.warn("Please add ONE child to <Link> (<Link>child</Link>)");const d=(0,s.h)("a",Object.assign({},a),...u);if(l===!0&&!(typeof window<"u"&&window.document)){const m=(0,s.h)("link",{rel:"prefetch",href:this.props.href,as:"document"}),p=(0,s.h)(i.Helmet,null,m);return(0,s.h)(o.Fragment,null,[p,d])}else return d}}return U.Link=r,U}var K={},Me;function pt(){return Me||(Me=1,(function(e){var t=K&&K.__rest||function(h,g){var S={};for(var _ in h)Object.prototype.hasOwnProperty.call(h,_)&&g.indexOf(_)<0&&(S[_]=h[_]);if(h!=null&&typeof Object.getOwnPropertySymbols=="function")for(var v=0,_=Object.getOwnPropertySymbols(h);v<_.length;v++)g.indexOf(_[v])<0&&Object.prototype.propertyIsEnumerable.call(h,_[v])&&(S[_[v]]=h[_[v]]);return S};Object.defineProperty(e,"__esModule",{value:!0}),e.parseParamsFromPath=e.Listener=e.Link=e.to=e.Route=e.Routes=e.Switch=e.matchPath=void 0;const i=$(),s=T(),o=[],r=h=>o.push(h),c=h=>o.splice(o.indexOf(h),1),n=h=>{window.history.pushState({},"",h),o.forEach(g=>g.handleChanges()),window.dispatchEvent(new Event("pushstate"))},u=h=>{window.history.replaceState({},"",h),o.forEach(g=>g.handleChanges()),window.dispatchEvent(new Event("replacestate"))},l=(h,g)=>{const{exact:S=!1,regex:_}=g;let{path:v}=g;if(!v)return{path:null,url:h,isExact:!0,params:{}};let O,j={};if(v.includes("/:")){const M=v.split("/"),w=h.split("/");M.forEach((x,fe)=>{if(/^:/.test(x)){const pe=x.slice(1),Xe=w[fe];if(_&&_[pe]&&!_[pe].test(Xe))return null;j=Object.assign(Object.assign({},j),{[pe]:Xe}),M[fe]=w[fe]}}),v=M.join("/")}if(v==="*"&&(O=[h]),O||(O=new RegExp(`^${v}`).exec(h)),!O)return null;const R=O[0],L=h===R;return S&&!L?null:{path:v,url:R,isExact:L,params:j}};e.matchPath=l;class f extends i.Component{constructor(){super(...arguments),this.index=0,this.path="",this.match={index:-1,path:""}}didMount(){window.addEventListener("popstate",this.handleChanges.bind(this)),r(this)}didUnmount(){window.removeEventListener("popstate",this.handleChanges.bind(this)),c(this)}handleChanges(){this.findChild(),this.shouldUpdate()&&this.update()}findChild(){this.match={index:-1,path:""},this.props.children=this.props.children.flat();for(let g=0;g<this.props.children.length;g++){const S=this.props.children[g],{path:_,exact:v,regex:O}=S.props;if((0,e.matchPath)((0,s.isSSR)()?_nano.location.pathname:window.location.pathname,{path:_,exact:v,regex:O})){this.match.index=g,this.match.path=_;return}}}shouldUpdate(){return this.path!==this.match.path||this.index!==this.match.index}render(){this.findChild();const g=this.props.children[this.match.index];if(this.match.index===-1&&(this.path="",this.index=0),g){const{path:S}=g.props;this.path=S,this.index=this.match.index;const _=(0,s._render)(g);return(0,s.h)("div",{},(0,s._render)(_))}else return this.props.fallback?(0,s.h)("div",{},(0,s._render)(this.props.fallback)):(0,s.h)("div",{},"not found")}}e.Switch=f;class y extends f{}e.Routes=y;const a=({path:h,regex:g,children:S})=>{const _=(0,s.isSSR)()?_nano.location.pathname:window.location.pathname,v=(0,e.parseParamsFromPath)(h);return S.forEach(O=>{O.props&&(O.props=Object.assign(Object.assign({},O.props),{route:{path:h,regex:g,pathname:_,params:v}}))}),S};e.Route=a;const d=(h,g=!1)=>{g?u(h):n(h)};e.to=d;const m=h=>{var{to:g,replace:S,children:_}=h,v=t(h,["to","replace","children"]);const O=j=>{j.preventDefault(),S?u(g):n(g)};return(0,s.h)("a",Object.assign({href:g,onClick:j=>O(j)},v),_)};e.Link=m;class p{constructor(){if(this._listeners=new Map,(0,s.isSSR)())return;this._route=window.location.pathname;const g=()=>{const S=window.location.pathname;this._listeners.forEach(_=>{_(S,this._route)}),this._route=S};window.addEventListener("pushstate",g),window.addEventListener("replacestate",g)}use(){const g=Math.random().toString(36).substring(2);return{subscribe:S=>{this._listeners.set(g,S)},cancel:()=>{this._listeners.has(g)&&this._listeners.delete(g)}}}}let b;const E=()=>(b||(b=new p),b);e.Listener=E;const P=h=>{let g={};const S=(0,s.isSSR)()?_nano.location.pathname.split("/"):window.location.pathname.split("/");return h.split("/").forEach((_,v)=>{_.startsWith(":")&&(g=Object.assign(Object.assign({},g),{[_.slice(1)]:S[v]}))}),g};e.parseParamsFromPath=P})(K)),K}var I={},Le;function gt(){if(Le)return I;Le=1;var e=I&&I.__awaiter||function(r,c,n,u){function l(f){return f instanceof n?f:new n(function(y){y(f)})}return new(n||(n=Promise))(function(f,y){function a(p){try{m(u.next(p))}catch(b){y(b)}}function d(p){try{m(u.throw(p))}catch(b){y(b)}}function m(p){p.done?f(p.value):l(p.value).then(a,d)}m((u=u.apply(r,c||[])).next())})},t=I&&I.__rest||function(r,c){var n={};for(var u in r)Object.prototype.hasOwnProperty.call(r,u)&&c.indexOf(u)<0&&(n[u]=r[u]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,u=Object.getOwnPropertySymbols(r);l<u.length;l++)c.indexOf(u[l])<0&&Object.prototype.propertyIsEnumerable.call(r,u[l])&&(n[u[l]]=r[u[l]]);return n};Object.defineProperty(I,"__esModule",{value:!0}),I.Suspense=void 0;const i=$(),s=T();class o extends i.Component{constructor(c){super(c),this.ready=!1;const n=this.props,{children:u,fallback:l,cache:f=!1}=n,y=t(n,["children","fallback","cache"]),a=JSON.stringify(y,function(d,m){return typeof m=="function"?`${m}`:m});this.id=(0,s.strToHash)(JSON.stringify(a))}didMount(){return e(this,void 0,void 0,function*(){const c=this.props,{children:n,fallback:u,cache:l=!1}=c,f=t(c,["children","fallback","cache"]);if(l&&(this.initState={}),this.loadFromCache(l))return;const y=Object.values(f).map(m=>m()),a=yield Promise.all(y),d=this.prepareData(f,a,l);this.addDataToChildren(d),this.ready=!0,this.update()})}ssr(){const c=this.props,{children:n,fallback:u,cache:l=!1}=c,f=t(c,["children","fallback","cache"]),y=Object.values(f).map(d=>d()),a=this.prepareData(f,y,!1);this.addDataToChildren(a)}loadFromCache(c){const n=this.state&&c&&Object.keys(this.state).length>0;return n&&(this.addDataToChildren(this.state),this.ready=!0),n}prepareData(c,n,u){return Object.keys(c).reduce((f,y,a)=>(u&&(this.state=Object.assign(Object.assign({},this.state),{[y]:n[a]})),Object.assign(Object.assign({},f),{[y]:n[a]})),{})}addDataToChildren(c){this.props.children.forEach(n=>{n.props&&(n.props=Object.assign(Object.assign({},n.props),c))})}render(){if((0,s.isSSR)())return this.ssr(),this.props.children;{const{cache:c=!1}=this.props;return this.loadFromCache(c),this.ready?this.props.children:this.props.fallback}}}return I.Suspense=o,I}var Q={},Te;function Ae(){if(Te)return Q;Te=1,Object.defineProperty(Q,"__esModule",{value:!0}),Q.Visible=void 0;const e=T(),t=$();class i extends t.Component{constructor(){super(...arguments),this.isVisible=!1}didMount(){new IntersectionObserver((r,c)=>{r.forEach(n=>{n.isIntersecting&&(c.disconnect(),this.isVisible=!0,this.update())})},{threshold:[0,1]}).observe(this.elements[0])}render(){return this.isVisible?(this.props.onVisible&&this.props.onVisible(),(0,e.render)(this.props.component||this.props.children[0])):(0,e.h)("div",{"data-visible":!1,visibility:"hidden"})}}return Q.Visible=i,Q}var ke;function _t(){return ke||(ke=1,(function(e){var t=q&&q.__createBinding||(Object.create?(function(l,f,y,a){a===void 0&&(a=y);var d=Object.getOwnPropertyDescriptor(f,y);(!d||("get"in d?!f.__esModule:d.writable||d.configurable))&&(d={enumerable:!0,get:function(){return f[y]}}),Object.defineProperty(l,a,d)}):(function(l,f,y,a){a===void 0&&(a=y),l[a]=f[y]})),i=q&&q.__setModuleDefault||(Object.create?(function(l,f){Object.defineProperty(l,"default",{enumerable:!0,value:f})}):function(l,f){l.default=f}),s=q&&q.__importStar||function(l){if(l&&l.__esModule)return l;var f={};if(l!=null)for(var y in l)y!=="default"&&Object.prototype.hasOwnProperty.call(l,y)&&t(f,l,y);return i(f,l),f};Object.defineProperty(e,"__esModule",{value:!0}),e.Visible=e.Suspense=e.Router=e.Link=e.Img=e.Helmet=void 0;var o=ce();Object.defineProperty(e,"Helmet",{enumerable:!0,get:function(){return o.Helmet}});var r=ht();Object.defineProperty(e,"Img",{enumerable:!0,get:function(){return r.Img}});var c=ft();Object.defineProperty(e,"Link",{enumerable:!0,get:function(){return c.Link}}),e.Router=s(pt());var n=gt();Object.defineProperty(e,"Suspense",{enumerable:!0,get:function(){return n.Suspense}});var u=Ae();Object.defineProperty(e,"Visible",{enumerable:!0,get:function(){return u.Visible}})})(q)),q}var de={},H={},qe;function mt(){if(qe)return H;qe=1,Object.defineProperty(H,"__esModule",{value:!0}),H.documentSSR=H.DocumentSSR=H.HTMLElementSSR=void 0;const e=Z();class t{constructor(r){this.isSelfClosing=!1,this.nodeType=null,this.tagName=r;const c=["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"];this.nodeType=1,c.indexOf(r)>=0?(this._ssr=`<${r} />`,this.isSelfClosing=!0):this._ssr=`<${r}></${r}>`}get outerHTML(){return this.toString()}get innerHTML(){return this.innerText}set innerHTML(r){this.innerText=r}get innerText(){var r;return((r=/(^<[^>]+>)(.+)?(<\/[a-z0-9]+>$|\/>$)/gm.exec(this._ssr))===null||r===void 0?void 0:r[2])||""}set innerText(r){const c=/(^<[^>]+>)(.+)?(<\/[a-z0-9]+>$|\/>$)/gm,n=(u,l,f,y)=>[l,r,y].join("");this._ssr=this._ssr.replace(c,n)}getAttribute(r){return null}get classList(){const r=this._ssr,c=/^<\w+.+(\sclass=")([^"]+)"/gm;return{add:n=>{this.setAttribute("class",n)},entries:{get length(){const n=c.exec(r);return n&&n[2]?n[2].split(" ").length:0}}}}toString(){return this._ssr}setAttributeNS(r,c,n){this.setAttribute(c,n)}setAttribute(r,c){const n=(l,f,y)=>`${f}${(0,e.escapeHtml)(r)}="${(0,e.escapeHtml)(c)}" ${y}`,u=(l,f,y)=>`${f} ${(0,e.escapeHtml)(r)}="${(0,e.escapeHtml)(c)}"${y}`;this.isSelfClosing?this._ssr=this._ssr.replace(/(^<[a-z0-9]+ )(.+)/gm,n):this._ssr=this._ssr.replace(/(^<[^>]+)(.+)/gm,u)}append(r){this.appendChild(r)}appendChild(r){const c=this._ssr.lastIndexOf("</");this._ssr=this._ssr.substring(0,c)+r+this._ssr.substring(c)}get children(){const r=/<([a-z0-9]+)((?!<\/\1).)*<\/\1>/gms,c=[];let n;for(;(n=r.exec(this.innerHTML))!==null;)c.push(n[0].replace(/[\s]+/gm," "));return c}addEventListener(r,c,n){}}H.HTMLElementSSR=t;class i{constructor(){this.body=this.createElement("body"),this.head=this.createElement("head")}createElement(r){return new t(r)}createElementNS(r,c){return this.createElement(c)}createTextNode(r){return(0,e.escapeHtml)(r)}querySelector(r){}}H.DocumentSSR=i;const s=()=>new i;return H.documentSSR=s,H}var Ie;function He(){return Ie||(Ie=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.clearState=e.renderSSR=e.initSSR=void 0;const t=T(),i=mt(),s=we(),o=Z(),r={isWebComponent:f=>typeof f=="string"&&f.includes("-")&&_nano.customElements.has(f),renderWebComponent:(f,y,a,d)=>{const m=_nano.customElements.get(f),b=d({component:m,props:Object.assign(Object.assign({},y),{children:a})}).toString().match(/^<(?<tag>[a-z]+)>(.*)<\/\k<tag>>$/);if(b){let P=function(h,g,S,_){return h.replace(g,"")};const E=document.createElement(b[1]);return E.innerText=b[2],E.innerText=E.innerText.replace(/<\w+[^>]*(\s(on\w*)="[^"]*")/gm,P),E}else return null}};(()=>{const f=(0,o.detectSSR)()===!0?!0:void 0,y={pathname:"/"},a=f?(0,i.documentSSR)():window.document;globalThis._nano={isSSR:f,location:y,document:a,customElements:new Map,ssrTricks:r}})();const n=(f="/")=>{_nano.location={pathname:f},globalThis.document=_nano.document=(0,t.isSSR)()?(0,i.documentSSR)():window.document};e.initSSR=n;const u=(f,y={})=>{const{pathname:a,clearState:d=!0}=y;(0,e.initSSR)(a),d&&s._state.clear();const m=(0,t.render)(f,null,!0);return Array.isArray(m)?m.join(""):Array.from(m).join("")};e.renderSSR=u;const l=()=>{s._state.clear()};e.clearState=l})(de)),de}var B={},G={},ie={},ee={},Ne;function $e(){return Ne||(Ne=1,Object.defineProperty(ee,"__esModule",{value:!0}),ee.MINI=void 0,ee.MINI=!1),ee}var he={},De;function yt(){return De||(De=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.build=e.evaluate=e.treeify=void 0;const t=$e(),i=0,s=1,o=2,r=3,c=4,n=5,u=6,l=0,f=2,y=3,a=4,d=n,m=u,p=(P,h)=>{const g=_=>{let v="",O=null;const j=[],R=[];for(let L=1;L<_.length;L++){const M=_[L++],w=_[L]?h[_[L++]-1]:_[++L];M===y?v=w:M===a?(j.push(w),O=null):M===d?(O||(O=Object.create(null),j.push(O)),O[_[++L]]=[w]):M===m?O[_[++L]].push(w):M===f?R.push(g(w)):M===l&&R.push(w)}return{tag:v,props:j,children:R}},{children:S}=g(P);return S.length>1?S:S[0]};e.treeify=p;const b=(P,h,g,S)=>{let _;h[0]=0;for(let v=1;v<h.length;v++){const O=h[v++],j=h[v]?(h[0]|=O?1:2,g[h[v++]]):h[++v];O===y?S[0]=j:O===a?S[1]=Object.assign(S[1]||{},j):O===d?(S[1]=S[1]||{})[h[++v]]=j:O===m?S[1][h[++v]]+=`${j}`:O?(_=P.apply(j,(0,e.evaluate)(P,j,g,["",null])),S.push(_),j[0]?h[0]|=2:(h[v-2]=l,h[v]=_)):S.push(j)}return S};e.evaluate=b;const E=function(P,...h){const g=[P,...h],S=this;let _=s,v="",O="",j=[0],R,L;const M=w=>{_===s&&(w||(v=v.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?t.MINI?j.push(w?g[w]:v):j.push(l,w,v):_===r&&(w||v)?(t.MINI?j[1]=w?g[w]:v:j.push(y,w,v),_=o):_===o&&v==="..."&&w?t.MINI?j[2]=Object.assign(j[2]||{},g[w]):j.push(a,w,0):_===o&&v&&!w?t.MINI?(j[2]=j[2]||{})[v]=!0:j.push(d,0,!0,v):_>=n&&(t.MINI?_===n?((j[2]=j[2]||{})[L]=w?v?v+g[w]:g[w]:v,_=u):(w||v)&&(j[2][L]+=w?v+g[w]:v):((v||!w&&_===n)&&(j.push(_,0,v,L),_=u),w&&(j.push(_,w,0,L),_=u))),v=""};for(let w=0;w<P.length;w++){w&&(_===s&&M(),M(w));for(let x=0;x<P[w].length;x++)R=P[w][x],_===s?R==="<"?(M(),t.MINI?j=[j,"",null]:j=[j],_=r):v+=R:_===c?v==="--"&&R===">"?(_=s,v=""):v=R+v[0]:O?R===O?O="":v+=R:R==='"'||R==="'"?O=R:R===">"?(M(),_=s):_&&(R==="="?(_=n,L=v,v=""):R==="/"&&(_<n||P[w][x+1]===">")?(M(),_===r&&(j=j[0]),_=j,t.MINI?(j=j[0]).push(S(..._.slice(1))):(j=j[0]).push(f,0,_),_=i):R===" "||R==="	"||R===`
`||R==="\r"?(M(),_=o):v+=R),_===r&&v==="!--"&&(_=c,j=j[0])}return M(),t.MINI?j.length>2?j.slice(1):j[1]:j};e.build=E})(he)),he}var Ve;function bt(){if(Ve)return ie;Ve=1,Object.defineProperty(ie,"__esModule",{value:!0});const e=$e(),t=yt(),i=new Map,s=function(o){let r=i.get(this);return r||(r=new Map,i.set(this,r)),r=(0,t.evaluate)(this,r.get(o)||(r.set(o,r=(0,t.build)(o)),r),arguments,[]),r.length>1?r:r[0]};return ie.default=e.MINI?t.build:s,ie}var Ue;function vt(){if(Ue)return G;Ue=1;var e=G&&G.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(G,"__esModule",{value:!0});const t=e(bt());return G.default=t.default,G}var Be;function St(){if(Be)return B;Be=1;var e=B&&B.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(B,"__esModule",{value:!0}),B.jsx=void 0;const t=T(),s=e(vt()).default.bind(t.h);return B.jsx=s,B}var te={},ze;function jt(){if(ze)return te;ze=1,Object.defineProperty(te,"__esModule",{value:!0}),te.hydrateLazy=void 0;const e=T(),t=Ae(),i=(s,o=null,r=!0)=>{const c=(0,e.h)(t.Visible,null,s);return(0,e.hydrate)(c,o,r)};return te.hydrateLazy=i,te}var ne={},Fe;function wt(){if(Fe)return ne;Fe=1,Object.defineProperty(ne,"__esModule",{value:!0}),ne.Store=void 0;const e=T();class t{constructor(s,o="",r="memory"){if(this._listeners=new Map,(0,e.isSSR)()&&(r="memory"),this._id=o,this._storage=r,this._state=this._prevState=s,r==="memory"||!r)return;const c=r==="local"?localStorage:sessionStorage,n=c.getItem(this._id);n?this._state=this._prevState=JSON.parse(n):c.setItem(this._id,JSON.stringify(s))}persist(s){if(this._storage==="memory")return;(this._storage==="local"?localStorage:sessionStorage).setItem(this._id,JSON.stringify(s))}clear(){this._state=this._prevState=void 0,this._storage==="local"?localStorage.removeItem(this._id):this._storage==="session"&&sessionStorage.removeItem(this._id)}setState(s){this.state=s}set state(s){this._prevState=this._state,this._state=s,this.persist(s),this._listeners.forEach(o=>{o(this._state,this._prevState)})}get state(){return this._state}use(){const s=Math.random().toString(36).substring(2,9),o=this;return{get state(){return o.state},setState:r=>{this.state=r},subscribe:r=>{this._listeners.set(s,r)},cancel:()=>{this._listeners.has(s)&&this._listeners.delete(s)}}}}return ne.Store=t,ne}var z={},xe;function Ot(){if(xe)return z;xe=1,Object.defineProperty(z,"__esModule",{value:!0}),z.useContext=z.createContext=void 0;const e=i=>{let s=i;return{Provider:o=>(o.value&&(s=o.value),o.children),Consumer:o=>({component:o.children[0](s),props:Object.assign(Object.assign({},o),{context:s})}),get:()=>s,set:o=>s=o}};z.createContext=e;const t=i=>{const s=i;if(s&&typeof s.get=="function")return s.get()};return z.useContext=t,z}var F={},Ge;function Pt(){if(Ge)return F;Ge=1;var e=F&&F.__rest||function(c,n){var u={};for(var l in c)Object.prototype.hasOwnProperty.call(c,l)&&n.indexOf(l)<0&&(u[l]=c[l]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,l=Object.getOwnPropertySymbols(c);f<l.length;f++)n.indexOf(l[f])<0&&Object.prototype.propertyIsEnumerable.call(c,l[f])&&(u[l[f]]=c[l[f]]);return u};Object.defineProperty(F,"__esModule",{value:!0}),F.withStyles=void 0;const t=T(),i=$(),s=ue(),o=ce(),r=(...c)=>n=>class extends i.Component{render(){const u=this.props,{children:l}=u,f=e(u,["children"]),y=[];c.forEach(d=>{var m;if(typeof d=="string")y.push((0,t.h)(o.Helmet,null,(0,t.h)("style",null,d)));else if(typeof d=="function"){const p=d();typeof p=="string"&&y.push((0,t.h)(o.Helmet,null,(0,t.h)("style",null,p)))}else if(typeof d=="object"){const p=(m=d.toString)===null||m===void 0?void 0:m.call(d);typeof p=="string"&&y.push((0,t.h)(o.Helmet,null,(0,t.h)("style",null,p)))}});const a=l&&l.length>0?(0,t.h)(n,Object.assign({},f),l):(0,t.h)(n,Object.assign({},this.props));return(0,t.h)(s.Fragment,null,...y,a)}};return F.withStyles=r,F}var re={},Je;function Ct(){if(Je)return re;Je=1,Object.defineProperty(re,"__esModule",{value:!0}),re.defineAsCustomElements=void 0;const e=T(),t=(s,o,r=[],c={})=>{/^[a-zA-Z0-9]+-[a-zA-Z0-9]+$/.test(o)?_nano.customElements.set(o,s):console.log(`Error: WebComponent name "${o}" is invalid.`)},i=function(s,o,r,c){if((0,e.isSSR)()){t(s,o,r);return}customElements.define(o,class extends HTMLElement{constructor(){super(),c?(this.attachShadow(c),this.$root=this.shadowRoot):this.$root=this;let n;const u=this.buildEl((0,e._render)({component:s,props:{ref:l=>n=l,children:Array.from(this.children).map(l=>(0,e.render)(l))}}));this.component=n,this.isFunctionalComponent=!s.isClass,this.functionalComponentsProps={},this.appendEl(u),this.isFunctionalComponent||(this.component.updatePropsValue=(l,f)=>{this.component.props||(this.component.props={}),this.component.props[l]=f,this.component[l]=f})}static get observedAttributes(){return r}buildEl(n){return(0,e.h)(this.shadowRoot?"div":"template",null,n)}appendEl(n){this.shadowRoot?this.$root.append(n):this.$root.append(...n.childNodes)}removeChildren(){var n;if(this.$root){const u=Array.from((n=this.$root)===null||n===void 0?void 0:n.children)||[];for(const l of u)l.remove()}}attributeChangedCallback(n,u,l){if(!this.isFunctionalComponent)this.component.updatePropsValue(n,l),this.component.update();else{this.removeChildren(),this.functionalComponentsProps[n]=l;const f=this.buildEl((0,e._render)({component:s,props:Object.assign({children:[],ref:y=>this.component=y},this.functionalComponentsProps)}));this.appendEl(f)}}})};return re.defineAsCustomElements=i,re}var We;function Rt(){return We||(We=1,(function(e){var t=D&&D.__createBinding||(Object.create?(function(P,h,g,S){S===void 0&&(S=g);var _=Object.getOwnPropertyDescriptor(h,g);(!_||("get"in _?!h.__esModule:_.writable||_.configurable))&&(_={enumerable:!0,get:function(){return h[g]}}),Object.defineProperty(P,S,_)}):(function(P,h,g,S){S===void 0&&(S=g),P[S]=h[g]})),i=D&&D.__exportStar||function(P,h){for(var g in P)g!=="default"&&!Object.prototype.hasOwnProperty.call(h,g)&&t(h,P,g)};Object.defineProperty(e,"__esModule",{value:!0}),e.VERSION=e.printVersion=e.defineAsCustomElements=e.withStyles=e.useContext=e.createContext=e.Store=e.Fragment=e.renderSSR=e.task=e.nodeToString=e.hydrateLazy=e.jsx=e.isSSR=e.Component=e.tick=e.hydrate=e.render=e.h=void 0;var s=T();Object.defineProperty(e,"h",{enumerable:!0,get:function(){return s.h}}),Object.defineProperty(e,"render",{enumerable:!0,get:function(){return s.render}}),Object.defineProperty(e,"hydrate",{enumerable:!0,get:function(){return s.hydrate}}),Object.defineProperty(e,"tick",{enumerable:!0,get:function(){return s.tick}});var o=$();Object.defineProperty(e,"Component",{enumerable:!0,get:function(){return o.Component}}),i(_t(),e);const r=T();Object.defineProperty(e,"isSSR",{enumerable:!0,get:function(){return r.isSSR}});const c=He();e.default={h:r.h,render:r.render,hydrate:r.hydrate,renderSSR:c.renderSSR,isSSR:r.isSSR};var n=St();Object.defineProperty(e,"jsx",{enumerable:!0,get:function(){return n.jsx}});var u=jt();Object.defineProperty(e,"hydrateLazy",{enumerable:!0,get:function(){return u.hydrateLazy}});var l=Z();Object.defineProperty(e,"nodeToString",{enumerable:!0,get:function(){return l.nodeToString}}),Object.defineProperty(e,"task",{enumerable:!0,get:function(){return l.task}});var f=He();Object.defineProperty(e,"renderSSR",{enumerable:!0,get:function(){return f.renderSSR}});var y=ue();Object.defineProperty(e,"Fragment",{enumerable:!0,get:function(){return y.Fragment}});var a=wt();Object.defineProperty(e,"Store",{enumerable:!0,get:function(){return a.Store}});var d=Ot();Object.defineProperty(e,"createContext",{enumerable:!0,get:function(){return d.createContext}}),Object.defineProperty(e,"useContext",{enumerable:!0,get:function(){return d.useContext}});var m=Pt();Object.defineProperty(e,"withStyles",{enumerable:!0,get:function(){return m.withStyles}});var p=Ct();Object.defineProperty(e,"defineAsCustomElements",{enumerable:!0,get:function(){return p.defineAsCustomElements}});var b=Z();Object.defineProperty(e,"printVersion",{enumerable:!0,get:function(){return b.printVersion}});var E=ve();Object.defineProperty(e,"VERSION",{enumerable:!0,get:function(){return E.VERSION}})})(D)),D}var oe=Rt();const Ze=dt(oe);class Et extends oe.Component{render(){return C("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px 16px",marginBottom:"12px",borderRadius:"8px",backgroundColor:"var(--color-neutral-background)",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:C("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[this.props.icon&&C("span",{style:{fontSize:"20px"},children:this.props.icon}),C("div",{children:[C("div",{style:{fontWeight:600,fontSize:"14px",marginBottom:"4px"},children:this.props.title}),C("div",{style:{fontSize:"12px",color:"var(--color-neutral-text)",opacity:.8},children:this.props.description})]})]})})}}class Mt extends oe.Component{render(){const{visible:t,onClose:i,items:s}=this.props;return C("div",{style:{display:t?"flex":"none",position:"fixed",top:0,left:0,width:"100%",height:"100%",alignItems:"center",justifyContent:"center",background:"rgba(0,0,0,0.5)",zIndex:9999},children:C("div",{style:{background:"var(--color-neutral-background)",padding:"20px",borderRadius:"8px",position:"relative",color:"var(--color-neutral-content-strong)",height:"85%",width:"85%"},children:[C("span",{style:{position:"absolute",top:"5px",right:"10px",cursor:"pointer",fontWeight:"bold"},onClick:i,children:"Ã—"}),C("h2",{children:"ReadIt Settings"}),C("div",{id:"settings-tile-container",children:s.map(o=>C(Et,{title:o.title,description:o.description}))})]})})}}class Lt extends oe.Component{render(){const{onClick:t}=this.props;return C("span",{"data-part":"create",class:"contents",children:C("create-post-entry-point-wrapper",{children:C("faceplate-tracker",{class:"nd:visible contents",source:"post_composer",action:"click",noun:"create_post",children:C("rpl-tooltip",{style:"--rpl-z-index-tooltip:1001",class:"nd:visible contents",placement:"bottom",appearance:"inverted",trigger:"hover focus-visible",distance:"8",children:[C("a",{rpl:"","aria-label":"ReadIt Settings",class:`no-underline hover:no-underline active:no-underline
                        button-medium px-[var(--rem8)]
                        button-plain icon items-center justify-center
                        button inline-flex`,id:"settings-open",onClick:t,children:[C("span",{class:"flex items-center justify-center",children:C("span",{class:"flex",children:C("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"#e3e3e3",children:C("path",{d:"m370-80-16-128q-13-5-24.5-12T307-235l-119 50L78-375l103-78q-1-7-1-13.5v-27q0-6.5 1-13.5L78-585l110-190 119 50q11-8 23-15t24-12l16-128h220l16 128q13 5 24.5 12t22.5 15l119-50 110 190-103 78q1 7 1 13.5v27q0 6.5-2 13.5l103 78-110 190-118-50q-11 8-23 15t-24 12L590-80H370Zm70-80h79l14-106q31-8 57.5-23.5T639-327l99 41 39-68-86-65q5-14 7-29.5t2-31.5q0-16-2-31.5t-7-29.5l86-65-39-68-99 42q-22-23-48.5-38.5T533-694l-13-106h-79l-14 106q-31 8-57.5 23.5T321-633l-99-41-39 68 86 64q-5 15-7 30t-2 32q0 16 2 31t7 30l-86 65 39 68 99-42q22 23 48.5 38.5T427-266l13 106Zm42-180q58 0 99-41t41-99q0-58-41-99t-99-41q-59 0-99.5 41T342-480q0 58 40.5 99t99.5 41Zm-2-140Z"})})})}),C("faceplate-screen-reader-content",{children:"ReadIt Settings"})]}),C("span",{slot:"content",children:"ReadIt Settings"})]})})})})}}class Tt{constructor(t){this.readit=t,this.visible=!1,this.tiles=[],this.isSettingsVisible=()=>document.getElementById("settings-open")!==null,this.open=()=>{this.visible=!0,this.render()},this.close=()=>{this.visible=!1,this.render()},this.toggle=()=>{this.visible=!this.visible,this.render()},this.modalContainer=document.createElement("div"),document.body.appendChild(this.modalContainer),this.injectButton(),this.patchRenderMethod(),this.render()}injectButton(){const t=document.querySelector("body > shreddit-app > reddit-header-large > reddit-header-action-items > header > nav > div.ps-lg.gap-xs.flex.items-center.justify-end > div:nth-child(2)");if(!t||this.isSettingsVisible())return;const i=document.createElement("div");t.appendChild(i),Ze.render(C(Lt,{onClick:this.open}),i)}patchRenderMethod(){const t=document.querySelector("shreddit-app");if(!t)return;const i=t.__proto__;if(i.__readitPatched)return;const s=i.render;i.render=function(...o){const r=s.call(this,...o);return this.readit?.settings?.injectButton?.(),r},i.__readitPatched=!0}registerSettingsTile(t){this.tiles.push(t),this.render()}render(){Ze.render(C(Mt,{visible:this.visible,onClose:this.close,items:this.tiles}),this.modalContainer)}}class At{constructor(t){this.readit=t,GM.getValue("readit-storage").then(i=>{i||GM.setValue("readit-storage",{})})}async load(){return await GM.getValue("readit-storage")??{}}async save(t){await GM.setValue("readit-storage",t)}async get(t,i,s){const o=await this.load();return o[t]&&i in o[t]?o[t][i]:s}async set(t,i,s){const o=await this.load();o[t]||(o[t]={}),o[t][i]=s,await this.save(o)}async delete(t,i){const s=await this.load();s[t]&&(delete s[t][i],await this.save(s))}async keys(t){const i=await this.load();return i[t]?Object.keys(i[t]):[]}async clear(t){const i=await this.load();i[t]&&(delete i[t],await this.save(i))}}class kt{constructor(){this.version=GM_info.script.version,this.posts=new Ye(this),this.settings=new Tt(this),this.plugins=new st(this),this.storage=new At(this),this.plugins.loadPlugins(),this.settings.registerSettingsTile({title:"ReadIt Version",description:this.version})}}const qt=new kt;unsafeWindow.readit=qt})();
