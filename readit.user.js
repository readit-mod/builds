// ==UserScript==
// @name         ReadIt
// @namespace    http://github.com/tralwdwd/
// @version      1.0.0
// @description  A userscript for Reddit Web with plugin support.
// @author       tralwdwd
// @match        https://*.reddit.com/*
// @icon         https://www.redditstatic.com/desktop2x/img/favicon/apple-icon-76x76.png
// @grant        GM.xmlHttpRequest
// @grant        unsafeWindow
// ==/UserScript==

// This code has been bundled, for source code go to https://github.com/readit


(function(){"use strict";class Xe{constructor(r){this.readit=r,this.selector="shreddit-post, shreddit-ad-post",this.postCallbacks=[],this._queuedPosts=new Set,this._rafScheduled=!1,this.registerOnPostsLoaded=o=>{this.postCallbacks.push(o),this._callbackInitialScan()},new MutationObserver(o=>{for(const a of o)for(const n of Array.from(a.addedNodes))n.nodeType===1&&n instanceof HTMLElement&&(n.matches(this.selector)&&this._queuedPosts.add(n),n.querySelectorAll(this.selector).forEach(t=>this._queuedPosts.add(t)));this._scheduleEmit()}).observe(document.body,{childList:!0,subtree:!0})}_callbackInitialScan(){const r=document.querySelectorAll(this.selector);r.length>0&&this._emitPosts(Array.from(r))}_scheduleEmit(){this._rafScheduled||(this._rafScheduled=!0,window.requestAnimationFrame(()=>{this._queuedPosts.size>0&&(this._emitPosts(Array.from(this._queuedPosts)),this._queuedPosts.clear()),this._rafScheduled=!1}))}_emitPosts(r){this.postCallbacks.forEach(l=>l(r))}}async function Ye(e){const r=await new Promise((a,n)=>{GM.xmlHttpRequest({method:"GET",url:e,onload:c=>a(c.responseText),onerror:c=>n(c)})}),l=new Blob([r],{type:"text/javascript"}),o=URL.createObjectURL(l);try{return await import(o)}finally{URL.revokeObjectURL(o)}}class Ke{constructor(r){this.readit=r,this.unloadedPluginList=[],this.loadedPluginList=[],localStorage.getItem("plugins")==null&&localStorage.setItem("plugins","[]");const l=JSON.parse(localStorage.getItem("plugins"));this.unloadedPluginList=l}get pluginList(){return this.loadedPluginList}definePlugin({name:r,description:l}){this.loadedPluginList.push({name:r,description:l})}async loadPlugins(){console.log(this.unloadedPluginList),this.unloadedPluginList.forEach(async r=>{try{await this.loadPlugin(r.url)}catch(l){console.error("Plugin execution failed, URL:",r.url,l)}})}async loadPlugin(r){try{const l=await Ye(r);l.default&&l.default(this.readit)}catch(l){console.error("Failed to load plugin:",l)}}addPlugin(r){localStorage.getItem("plugins")==null&&localStorage.setItem("plugins","[]");const l=JSON.parse(localStorage.getItem("plugins"));l.push({url:r}),localStorage.setItem("plugins",JSON.stringify(l)),alert("New Plugins require a reload!")}}const N=()=>typeof _nano<"u"&&_nano.isSSR===!0,Qe=Promise.prototype.then.bind(Promise.resolve()),et=e=>{let r=0;for(let l=0;l<e.length;l++){const o=e.charCodeAt(l);r=(r<<5)-r+o,r|=0}return Math.abs(r).toString(32)},se=(e,r,l=!0)=>{if(!Array.isArray(r)){se(e,[r],l);return}typeof r=="object"&&(r=Array.prototype.slice.call(r)),r.forEach(o=>{if(Array.isArray(o))se(e,o,l);else{const a=q(o);typeof a<"u"&&(Array.isArray(a)?se(e,a,l):N()&&!l?e.appendChild(a.nodeType==null?a.toString():a):e.appendChild(a.nodeType==null?document.createTextNode(a.toString()):a))}})},tt=e=>{const r=e.children[0],l=r.attributes;if(N())return r;const o=_e("svg");for(let a=l.length-1;a>=0;a--)o.setAttribute(l[a].name,l[a].value);return o.innerHTML=r.innerHTML,o},q=e=>{if(e===null||e===!1||typeof e>"u")return[];if(typeof e=="string"||typeof e=="number")return e.toString();if(e.tagName&&e.tagName.toLowerCase()==="svg")return tt({children:[e]});if(e.tagName||e&&e.nodeType===3)return e;if(e&&e.component&&e.component.isClass)return me(e);if(e.isClass)return me({component:e,props:{}});if(e.component&&typeof e.component=="function")return nt(e);if(Array.isArray(e))return e.map(r=>q(r)).flat();if(typeof e=="function"&&!e.isClass)return q(e());if(e.component&&e.component.tagName&&typeof e.component.tagName=="string"||Array.isArray(e.component)||e.component)return q(e.component);if(typeof e=="object")return[];console.warn("Something unexpected happened with:",e)},nt=e=>{const{component:r,props:l}=e;return q(r(l))},me=e=>{const{component:r,props:l}=e,o=et(r.toString());r.prototype._getHash=()=>o;const a=new r(l);N()||a.willMount();let n=a.render();return n=q(n),a.elements=n,l&&l.ref&&l.ref(a),N()||Qe(()=>{a._didMount()}),n},_e=e=>document.createElementNS("http://www.w3.org/2000/svg",e),rt=(e,r={},...l)=>{if(r&&r.children&&(Array.isArray(l)?Array.isArray(r.children)?l=[...r.children,...l]:l.push(r.children):Array.isArray(r.children)?l=r.children:l=[r.children]),N()&&_nano.ssrTricks.isWebComponent(e)){const t=_nano.ssrTricks.renderWebComponent(e,r,l,q);return t===null?`ERROR: "<${e} />"`:t}if(typeof e!="string")return{component:e,props:Object.assign(Object.assign({},r),{children:l})};try{if(N()&&typeof e=="string"&&!document)throw new Error("document is not defined")}catch(t){console.log("ERROR:",t.message,`
 > Please read: https://github.com/nanojsx/nano/issues/106`)}let o;const a=e==="svg"?_e("svg"):document.createElement(e),n=(t,u)=>u.indexOf("on")!==0?!1:t._ssr?!0:typeof t[u]=="object"||typeof t[u]=="function";for(const t in r){if(t==="style"&&typeof r[t]=="object"){const u=Object.keys(r[t]).map(i=>`${i}:${r[t][i]}`).join(";").replace(/[A-Z]/g,i=>`-${i.toLowerCase()}`);r[t]=`${u};`}if(t==="ref")o=r[t];else if(n(a,t.toLowerCase()))a.addEventListener(t.toLowerCase().substring(2),u=>r[t](u));else if(t==="dangerouslySetInnerHTML"&&r[t].__html)if(N())a.innerHTML=r[t].__html;else{const u=document.createElement("fragment");u.innerHTML=r[t].__html,a.appendChild(u)}else if(t==="innerHTML"&&r[t].__dangerousHtml)if(N())a.innerHTML=r[t].__dangerousHtml;else{const u=document.createElement("fragment");u.innerHTML=r[t].__dangerousHtml,a.appendChild(u)}else/^className$/i.test(t)?a.setAttribute("class",r[t]):typeof r[t]<"u"&&a.setAttribute(t,r[t])}const c=!["noscript","script","style"].includes(e);return se(a,l,c),o&&o(a),a};var st=function(e,r){var l={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&r.indexOf(o)<0&&(l[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,o=Object.getOwnPropertySymbols(e);a<o.length;a++)r.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(l[o[a]]=e[o[a]]);return l};const P=function(e,r){let{children:l=[]}=r,o=st(r,["children"]);return Array.isArray(l)||(l=[l]),rt(e,o,...l)};function it(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var D={},ae={},ge;function T(){return ge||(ge=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.h=e._render=e.hydrate=e.render=e.appendChildren=e.strToHash=e.removeAllChildNodes=e.tick=e.isSSR=void 0;const r=()=>typeof _nano<"u"&&_nano.isSSR===!0;e.isSSR=r,e.tick=Promise.prototype.then.bind(Promise.resolve());const l=s=>{for(;s.firstChild;)s.removeChild(s.firstChild)};e.removeAllChildNodes=l;const o=s=>{let d=0;for(let g=0;g<s.length;g++){const p=s.charCodeAt(g);d=(d<<5)-d+p,d|=0}return Math.abs(d).toString(32)};e.strToHash=o;const a=(s,d,g=!0)=>{if(!Array.isArray(d)){(0,e.appendChildren)(s,[d],g);return}typeof d=="object"&&(d=Array.prototype.slice.call(d)),d.forEach(p=>{if(Array.isArray(p))(0,e.appendChildren)(s,p,g);else{const b=(0,e._render)(p);typeof b<"u"&&(Array.isArray(b)?(0,e.appendChildren)(s,b,g):(0,e.isSSR)()&&!g?s.appendChild(b.nodeType==null?b.toString():b):s.appendChild(b.nodeType==null?document.createTextNode(b.toString()):b))}})};e.appendChildren=a;const n=s=>{const d=s.children[0],g=d.attributes;if((0,e.isSSR)())return d;const p=f("svg");for(let b=g.length-1;b>=0;b--)p.setAttribute(g[b].name,g[b].value);return p.innerHTML=d.innerHTML,p},c=(s,d=null,g=!0)=>{let p=(0,e._render)(s);return Array.isArray(p)&&(p=p.map(b=>(0,e._render)(b)),p.length===1&&(p=p[0])),d?(g&&(0,e.removeAllChildNodes)(d),p&&d.id&&d.id===p.id&&d.parentElement?d.parentElement.replaceChild(p,d):Array.isArray(p)?p.forEach(b=>{(0,e.appendChildren)(d,(0,e._render)(b))}):(0,e.appendChildren)(d,(0,e._render)(p)),d):(0,e.isSSR)()&&!Array.isArray(p)?[p]:p};e.render=c,e.hydrate=e.render;const t=s=>{if(s===null||s===!1||typeof s>"u")return[];if(typeof s=="string"||typeof s=="number")return s.toString();if(s.tagName&&s.tagName.toLowerCase()==="svg")return n({children:[s]});if(s.tagName||s&&s.nodeType===3)return s;if(s&&s.component&&s.component.isClass)return i(s);if(s.isClass)return i({component:s,props:{}});if(s.component&&typeof s.component=="function")return u(s);if(Array.isArray(s))return s.map(d=>(0,e._render)(d)).flat();if(typeof s=="function"&&!s.isClass)return(0,e._render)(s());if(s.component&&s.component.tagName&&typeof s.component.tagName=="string"||Array.isArray(s.component)||s.component)return(0,e._render)(s.component);if(typeof s=="object")return[];console.warn("Something unexpected happened with:",s)};e._render=t;const u=s=>{const{component:d,props:g}=s;return(0,e._render)(d(g))},i=s=>{const{component:d,props:g}=s,p=(0,e.strToHash)(d.toString());d.prototype._getHash=()=>p;const b=new d(g);(0,e.isSSR)()||b.willMount();let E=b.render();return E=(0,e._render)(E),b.elements=E,g&&g.ref&&g.ref(b),(0,e.isSSR)()||(0,e.tick)(()=>{b._didMount()}),E},f=s=>document.createElementNS("http://www.w3.org/2000/svg",s),y=(s,d={},...g)=>{if(d&&d.children&&(Array.isArray(g)?Array.isArray(d.children)?g=[...d.children,...g]:g.push(d.children):Array.isArray(d.children)?g=d.children:g=[d.children]),(0,e.isSSR)()&&_nano.ssrTricks.isWebComponent(s)){const h=_nano.ssrTricks.renderWebComponent(s,d,g,e._render);return h===null?`ERROR: "<${s} />"`:h}if(typeof s!="string")return{component:s,props:Object.assign(Object.assign({},d),{children:g})};try{if((0,e.isSSR)()&&typeof s=="string"&&!document)throw new Error("document is not defined")}catch(h){console.log("ERROR:",h.message,`
 > Please read: https://github.com/nanojsx/nano/issues/106`)}let p;const b=s==="svg"?f("svg"):document.createElement(s),E=(h,m)=>m.indexOf("on")!==0?!1:h._ssr?!0:typeof h[m]=="object"||typeof h[m]=="function";for(const h in d){if(h==="style"&&typeof d[h]=="object"){const m=Object.keys(d[h]).map(S=>`${S}:${d[h][S]}`).join(";").replace(/[A-Z]/g,S=>`-${S.toLowerCase()}`);d[h]=`${m};`}if(h==="ref")p=d[h];else if(E(b,h.toLowerCase()))b.addEventListener(h.toLowerCase().substring(2),m=>d[h](m));else if(h==="dangerouslySetInnerHTML"&&d[h].__html)if((0,e.isSSR)())b.innerHTML=d[h].__html;else{const m=document.createElement("fragment");m.innerHTML=d[h].__html,b.appendChild(m)}else if(h==="innerHTML"&&d[h].__dangerousHtml)if((0,e.isSSR)())b.innerHTML=d[h].__dangerousHtml;else{const m=document.createElement("fragment");m.innerHTML=d[h].__dangerousHtml,b.appendChild(m)}else/^className$/i.test(h)?b.setAttribute("class",d[h]):typeof d[h]<"u"&&b.setAttribute(h,d[h])}const C=!["noscript","script","style"].includes(s);return(0,e.appendChildren)(b,g,C),p&&p(b),b};e.h=y})(ae)),ae}var W={},A={},G={},ye;function be(){return ye||(ye=1,Object.defineProperty(G,"__esModule",{value:!0}),G.VERSION=void 0,G.VERSION="0.1.0"),G}var ve;function Z(){if(ve)return A;ve=1,Object.defineProperty(A,"__esModule",{value:!0}),A.printVersion=A.escapeHtml=A.onNodeRemove=A.detectSSR=A.nodeToString=A.task=void 0;const e=be(),r=u=>setTimeout(u,0);A.task=r;const l=u=>{const i=document.createElement("div");return i.appendChild(u.cloneNode(!0)),i.innerHTML};A.nodeToString=l;const o=()=>{const u=typeof Deno<"u",i=typeof window<"u";return typeof _nano<"u"&&_nano.isSSR||u||!i};A.detectSSR=o;function a(u,i){return!!u&&(u===i||a(u.parentNode,i))}const n=(u,i)=>{let f=new MutationObserver(y=>{y.forEach(s=>{s.removedNodes.forEach(d=>{a(u,d)&&(i(),f&&(f.disconnect(),f=void 0))})})});return f.observe(document,{childList:!0,subtree:!0}),f};A.onNodeRemove=n;const c=u=>u&&typeof u=="string"?u.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):u;A.escapeHtml=c;const t=()=>{const u=`Powered by nano JSX v${e.VERSION}`;console.log(`%c %c %c %c %c ${u} %c http://nanojsx.io`,"background: #ff0000","background: #ffff00","background: #00ff00","background: #00ffff","color: #fff; background: #000000;","background: none")};return A.printVersion=t,A}var le={},Se;function je(){return Se||(Se=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e._clearState=e._state=void 0,e._state=new Map;const r=()=>{e._state.clear()};e._clearState=r})(le)),le}var Oe;function $(){if(Oe)return W;Oe=1,Object.defineProperty(W,"__esModule",{value:!0}),W.Component=void 0;const e=Z(),r=T(),l=je();class o{constructor(n){this._elements=[],this._skipUnmount=!1,this._hasUnmounted=!1,this.props=n||{},this.id=this._getHash()}static get isClass(){return!0}get isClass(){return!0}setState(n,c=!1){typeof n=="object"&&n!==null&&this.state!==void 0?this.state=Object.assign(Object.assign({},this.state),n):this.state=n,c&&this.update()}set state(n){l._state.set(this.id,n)}get state(){return l._state.get(this.id)}set initState(n){this.state===void 0&&(this.state=n)}get elements(){return this._elements||[]}set elements(n){Array.isArray(n)||(n=[n]),n.forEach(c=>{this._elements.push(c)})}_addNodeRemoveListener(){/^[^{]+{\s+}$/gm.test(this.didUnmount.toString())||(0,e.onNodeRemove)(this.elements[0],()=>{this._skipUnmount||this._didUnmount()})}_didMount(){this._addNodeRemoveListener(),this.didMount()}_willUpdate(){this.willUpdate()}_didUpdate(){this.didUpdate()}_didUnmount(){this._hasUnmounted||(this.didUnmount(),this._hasUnmounted=!0)}willMount(){}didMount(){}willUpdate(){}didUpdate(){}didUnmount(){}render(n){}update(n){this._skipUnmount=!0,this._willUpdate();const c=[...this.elements];this._elements=[];let t=this.render(n);t=(0,r._render)(t),this.elements=t;const u=c[0].parentElement;u||console.warn("Component needs a parent element to get updated!"),this.elements.forEach(i=>{u&&u.insertBefore(i,c[0])}),c.forEach(i=>{this.elements.includes(i)||(i.remove(),i=null)}),this._addNodeRemoveListener(),(0,r.tick)(()=>{this._skipUnmount=!1,this.elements[0].isConnected?this._didUpdate():this._didUnmount()})}_getHash(){}}return W.Component=o,W}var H={},X={},we;function ce(){if(we)return X;we=1,Object.defineProperty(X,"__esModule",{value:!0}),X.Helmet=void 0;const e=$(),r=T();class l extends Map{toString(){let n="";for(const[c,t]of this)n+=` ${c}="${t}"`;return n.trim()}}class o extends e.Component{static SSR(n){var c,t;const u=/(<helmet\b[^>]*>)((.|\r|\n)*?)(<\/helmet>)/gm,i=[],f=[],y={html:new l,body:new l};if(typeof document<"u"&&document.head){let g=[];g=[].slice.call(document.head.children);for(let p=0;p<g.length;p++)i.indexOf(g[p])===-1&&i.push(g[p])}let s;for(;(s=u.exec(n))!==null;){const g=s[1];let p=s[2];const b=/<html\s([^>]+)><\/html>/gm,E=/<body\s([^>]+)><\/body>/gm,C=/(\w+)="([^"]+)"/gm;let h=null;(c=n.match(b))===null||c===void 0||c.forEach(S=>{for(p=p.replace(S,"");(h=C.exec(S))!==null;)y.html.set(h[1],h[2])}),(t=n.match(E))===null||t===void 0||t.forEach(S=>{for(p=p.replace(S,"");(h=C.exec(S))!==null;)y.body.set(h[1],h[2])});const m=g.includes('data-placement="head"');m&&!i.includes(p)?i.push(p):!m&&!f.includes(p)&&f.push(p)}return{body:n.replace(u,""),head:i,footer:f,attributes:y}}didMount(){this.props.children.forEach(n=>{var c,t,u,i;if(!(n instanceof HTMLElement))return;const f=this.props.footer?document.body:document.head,y=n.tagName;let s=[];s.push(n.innerText);for(let p=0;p<n.attributes.length;p++)s.push((c=n.attributes.item(p))===null||c===void 0?void 0:c.name.toLowerCase()),s.push((t=n.attributes.item(p))===null||t===void 0?void 0:t.value.toLowerCase());if(y==="HTML"||y==="BODY"){const p=document.getElementsByTagName(y)[0];for(let b=1;b<s.length;b+=2)p.setAttribute(s[b],s[b+1]);return}else if(y==="TITLE"){const p=document.getElementsByTagName("TITLE");if(p.length>0){const b=n;p[0].text=b.text}else{const b=(0,r.h)("title",null,n.innerHTML);(0,r.appendChildren)(f,[b],!1)}return}let d=!1;s=s.sort();const g=document.getElementsByTagName(y);for(let p=0;p<g.length;p++){let b=[];b.push(g[p].innerText);for(let E=0;E<g[p].attributes.length;E++)b.push((u=g[p].attributes.item(E))===null||u===void 0?void 0:u.name.toLowerCase()),b.push((i=g[p].attributes.item(E))===null||i===void 0?void 0:i.value.toLowerCase());b=b.sort(),s.length>0&&b.length>0&&JSON.stringify(s)===JSON.stringify(b)&&(d=!0)}d||(0,r.appendChildren)(f,[n],!1)})}render(){const n=this.props.footer?"footer":"head";return(0,r.isSSR)()?(0,r.h)("helmet",{"data-ssr":!0,"data-placement":n},this.props.children):[]}}return X.Helmet=o,X}var V={},Ce;function ot(){if(Ce)return V;Ce=1;var e=V&&V.__rest||function(a,n){var c={};for(var t in a)Object.prototype.hasOwnProperty.call(a,t)&&n.indexOf(t)<0&&(c[t]=a[t]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,t=Object.getOwnPropertySymbols(a);u<t.length;u++)n.indexOf(t[u])<0&&Object.prototype.propertyIsEnumerable.call(a,t[u])&&(c[t[u]]=a[t[u]]);return c};Object.defineProperty(V,"__esModule",{value:!0}),V.Img=void 0;const r=$(),l=T();class o extends r.Component{constructor(n){super(n);const{src:c,key:t}=n;this.id=`${(0,l.strToHash)(c)}-${(0,l.strToHash)(JSON.stringify(n))}`,t&&(this.id+=`key-${t}`),this.state||this.setState({isLoaded:!1,image:void 0})}didMount(){const n=this.props,{lazy:c=!0,placeholder:t,children:u,key:i,ref:f}=n,y=e(n,["lazy","placeholder","children","key","ref"]);if(typeof c=="boolean"&&c===!1)return;new IntersectionObserver((d,g)=>{d.forEach(p=>{p.isIntersecting&&(g.disconnect(),this.state.image=(0,l.h)("img",Object.assign({},y)),this.state.image.complete?(this.state.isLoaded=!0,this.update()):this.state.image.onload=()=>{this.state.isLoaded=!0,this.update()})})},{threshold:[0,1]}).observe(this.elements[0])}render(){const n=this.props,{src:c,placeholder:t,children:u,lazy:i=!0,key:f,ref:y}=n,s=e(n,["src","placeholder","children","lazy","key","ref"]);if(typeof i=="boolean"&&i===!1)return this.state.image=(0,l.h)("img",Object.assign({src:c},s)),this.state.image;if(this.state.isLoaded)return this.state.image;if(t&&typeof t=="string")return(0,l.h)("img",Object.assign({src:t},s));if(t&&typeof t=="function")return t();{const d={};s.width&&(d.width=`${s.width}px`),s.height&&(d.height=`${s.height}px`);const{width:g,height:p}=s,b=e(s,["width","height"]);return(0,l.h)("div",Object.assign({style:d},b))}}}return V.Img=o,V}var U={},Y={},Pe;function ue(){if(Pe)return Y;Pe=1,Object.defineProperty(Y,"__esModule",{value:!0}),Y.Fragment=void 0;const e=r=>r.children;return Y.Fragment=e,Y}var Re;function at(){if(Re)return U;Re=1;var e=U&&U.__rest||function(c,t){var u={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&t.indexOf(i)<0&&(u[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,i=Object.getOwnPropertySymbols(c);f<i.length;f++)t.indexOf(i[f])<0&&Object.prototype.propertyIsEnumerable.call(c,i[f])&&(u[i[f]]=c[i[f]]);return u};Object.defineProperty(U,"__esModule",{value:!0}),U.Link=void 0;const r=$(),l=ce(),o=T(),a=ue();class n extends r.Component{prefetchOnHover(){this.elements[0].addEventListener("mouseover",()=>this.addPrefetch(),{once:!0})}prefetchOnVisible(){new IntersectionObserver((u,i)=>{u.forEach(f=>{f.isIntersecting&&(i.disconnect(),this.addPrefetch())})},{threshold:[0,1]}).observe(this.elements[0])}addPrefetch(){let t=!1;const u=document.getElementsByTagName("link");for(let i=0;i<u.length;i++)u[i].getAttribute("rel")==="prefetch"&&u[i].getAttribute("href")===this.props.href&&(t=!0);if(!t){const i=(0,o.h)("link",{rel:"prefetch",href:this.props.href,as:"document"});document.head.appendChild(i)}}didMount(){const{href:t,prefetch:u,delay:i=0,back:f=!1}=this.props;f&&this.elements[0].addEventListener("click",y=>{y.preventDefault();const s=y.target;s.href===document.referrer?window.history.back():window.location.href=s.href}),i>0&&this.elements[0].addEventListener("click",y=>{y.preventDefault(),setTimeout(()=>window.location.href=t,i)}),u&&(u==="hover"?this.prefetchOnHover():u==="visible"?this.prefetchOnVisible():this.addPrefetch())}render(){const t=this.props,{children:u,prefetch:i,back:f,ref:y}=t,s=e(t,["children","prefetch","back","ref"]);this.props.href||console.warn('Please add "href" to <Link>'),u.length!==1&&console.warn("Please add ONE child to <Link> (<Link>child</Link>)");const d=(0,o.h)("a",Object.assign({},s),...u);if(i===!0&&!(typeof window<"u"&&window.document)){const g=(0,o.h)("link",{rel:"prefetch",href:this.props.href,as:"document"}),p=(0,o.h)(l.Helmet,null,g);return(0,o.h)(a.Fragment,null,[p,d])}else return d}}return U.Link=n,U}var K={},Ee;function lt(){return Ee||(Ee=1,(function(e){var r=K&&K.__rest||function(h,m){var S={};for(var _ in h)Object.prototype.hasOwnProperty.call(h,_)&&m.indexOf(_)<0&&(S[_]=h[_]);if(h!=null&&typeof Object.getOwnPropertySymbols=="function")for(var v=0,_=Object.getOwnPropertySymbols(h);v<_.length;v++)m.indexOf(_[v])<0&&Object.prototype.propertyIsEnumerable.call(h,_[v])&&(S[_[v]]=h[_[v]]);return S};Object.defineProperty(e,"__esModule",{value:!0}),e.parseParamsFromPath=e.Listener=e.Link=e.to=e.Route=e.Routes=e.Switch=e.matchPath=void 0;const l=$(),o=T(),a=[],n=h=>a.push(h),c=h=>a.splice(a.indexOf(h),1),t=h=>{window.history.pushState({},"",h),a.forEach(m=>m.handleChanges()),window.dispatchEvent(new Event("pushstate"))},u=h=>{window.history.replaceState({},"",h),a.forEach(m=>m.handleChanges()),window.dispatchEvent(new Event("replacestate"))},i=(h,m)=>{const{exact:S=!1,regex:_}=m;let{path:v}=m;if(!v)return{path:null,url:h,isExact:!0,params:{}};let w,j={};if(v.includes("/:")){const M=v.split("/"),O=h.split("/");M.forEach((x,fe)=>{if(/^:/.test(x)){const pe=x.slice(1),Ze=O[fe];if(_&&_[pe]&&!_[pe].test(Ze))return null;j=Object.assign(Object.assign({},j),{[pe]:Ze}),M[fe]=O[fe]}}),v=M.join("/")}if(v==="*"&&(w=[h]),w||(w=new RegExp(`^${v}`).exec(h)),!w)return null;const R=w[0],L=h===R;return S&&!L?null:{path:v,url:R,isExact:L,params:j}};e.matchPath=i;class f extends l.Component{constructor(){super(...arguments),this.index=0,this.path="",this.match={index:-1,path:""}}didMount(){window.addEventListener("popstate",this.handleChanges.bind(this)),n(this)}didUnmount(){window.removeEventListener("popstate",this.handleChanges.bind(this)),c(this)}handleChanges(){this.findChild(),this.shouldUpdate()&&this.update()}findChild(){this.match={index:-1,path:""},this.props.children=this.props.children.flat();for(let m=0;m<this.props.children.length;m++){const S=this.props.children[m],{path:_,exact:v,regex:w}=S.props;if((0,e.matchPath)((0,o.isSSR)()?_nano.location.pathname:window.location.pathname,{path:_,exact:v,regex:w})){this.match.index=m,this.match.path=_;return}}}shouldUpdate(){return this.path!==this.match.path||this.index!==this.match.index}render(){this.findChild();const m=this.props.children[this.match.index];if(this.match.index===-1&&(this.path="",this.index=0),m){const{path:S}=m.props;this.path=S,this.index=this.match.index;const _=(0,o._render)(m);return(0,o.h)("div",{},(0,o._render)(_))}else return this.props.fallback?(0,o.h)("div",{},(0,o._render)(this.props.fallback)):(0,o.h)("div",{},"not found")}}e.Switch=f;class y extends f{}e.Routes=y;const s=({path:h,regex:m,children:S})=>{const _=(0,o.isSSR)()?_nano.location.pathname:window.location.pathname,v=(0,e.parseParamsFromPath)(h);return S.forEach(w=>{w.props&&(w.props=Object.assign(Object.assign({},w.props),{route:{path:h,regex:m,pathname:_,params:v}}))}),S};e.Route=s;const d=(h,m=!1)=>{m?u(h):t(h)};e.to=d;const g=h=>{var{to:m,replace:S,children:_}=h,v=r(h,["to","replace","children"]);const w=j=>{j.preventDefault(),S?u(m):t(m)};return(0,o.h)("a",Object.assign({href:m,onClick:j=>w(j)},v),_)};e.Link=g;class p{constructor(){if(this._listeners=new Map,(0,o.isSSR)())return;this._route=window.location.pathname;const m=()=>{const S=window.location.pathname;this._listeners.forEach(_=>{_(S,this._route)}),this._route=S};window.addEventListener("pushstate",m),window.addEventListener("replacestate",m)}use(){const m=Math.random().toString(36).substring(2);return{subscribe:S=>{this._listeners.set(m,S)},cancel:()=>{this._listeners.has(m)&&this._listeners.delete(m)}}}}let b;const E=()=>(b||(b=new p),b);e.Listener=E;const C=h=>{let m={};const S=(0,o.isSSR)()?_nano.location.pathname.split("/"):window.location.pathname.split("/");return h.split("/").forEach((_,v)=>{_.startsWith(":")&&(m=Object.assign(Object.assign({},m),{[_.slice(1)]:S[v]}))}),m};e.parseParamsFromPath=C})(K)),K}var k={},Me;function ct(){if(Me)return k;Me=1;var e=k&&k.__awaiter||function(n,c,t,u){function i(f){return f instanceof t?f:new t(function(y){y(f)})}return new(t||(t=Promise))(function(f,y){function s(p){try{g(u.next(p))}catch(b){y(b)}}function d(p){try{g(u.throw(p))}catch(b){y(b)}}function g(p){p.done?f(p.value):i(p.value).then(s,d)}g((u=u.apply(n,c||[])).next())})},r=k&&k.__rest||function(n,c){var t={};for(var u in n)Object.prototype.hasOwnProperty.call(n,u)&&c.indexOf(u)<0&&(t[u]=n[u]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,u=Object.getOwnPropertySymbols(n);i<u.length;i++)c.indexOf(u[i])<0&&Object.prototype.propertyIsEnumerable.call(n,u[i])&&(t[u[i]]=n[u[i]]);return t};Object.defineProperty(k,"__esModule",{value:!0}),k.Suspense=void 0;const l=$(),o=T();class a extends l.Component{constructor(c){super(c),this.ready=!1;const t=this.props,{children:u,fallback:i,cache:f=!1}=t,y=r(t,["children","fallback","cache"]),s=JSON.stringify(y,function(d,g){return typeof g=="function"?`${g}`:g});this.id=(0,o.strToHash)(JSON.stringify(s))}didMount(){return e(this,void 0,void 0,function*(){const c=this.props,{children:t,fallback:u,cache:i=!1}=c,f=r(c,["children","fallback","cache"]);if(i&&(this.initState={}),this.loadFromCache(i))return;const y=Object.values(f).map(g=>g()),s=yield Promise.all(y),d=this.prepareData(f,s,i);this.addDataToChildren(d),this.ready=!0,this.update()})}ssr(){const c=this.props,{children:t,fallback:u,cache:i=!1}=c,f=r(c,["children","fallback","cache"]),y=Object.values(f).map(d=>d()),s=this.prepareData(f,y,!1);this.addDataToChildren(s)}loadFromCache(c){const t=this.state&&c&&Object.keys(this.state).length>0;return t&&(this.addDataToChildren(this.state),this.ready=!0),t}prepareData(c,t,u){return Object.keys(c).reduce((f,y,s)=>(u&&(this.state=Object.assign(Object.assign({},this.state),{[y]:t[s]})),Object.assign(Object.assign({},f),{[y]:t[s]})),{})}addDataToChildren(c){this.props.children.forEach(t=>{t.props&&(t.props=Object.assign(Object.assign({},t.props),c))})}render(){if((0,o.isSSR)())return this.ssr(),this.props.children;{const{cache:c=!1}=this.props;return this.loadFromCache(c),this.ready?this.props.children:this.props.fallback}}}return k.Suspense=a,k}var Q={},Le;function Te(){if(Le)return Q;Le=1,Object.defineProperty(Q,"__esModule",{value:!0}),Q.Visible=void 0;const e=T(),r=$();class l extends r.Component{constructor(){super(...arguments),this.isVisible=!1}didMount(){new IntersectionObserver((n,c)=>{n.forEach(t=>{t.isIntersecting&&(c.disconnect(),this.isVisible=!0,this.update())})},{threshold:[0,1]}).observe(this.elements[0])}render(){return this.isVisible?(this.props.onVisible&&this.props.onVisible(),(0,e.render)(this.props.component||this.props.children[0])):(0,e.h)("div",{"data-visible":!1,visibility:"hidden"})}}return Q.Visible=l,Q}var Ae;function ut(){return Ae||(Ae=1,(function(e){var r=H&&H.__createBinding||(Object.create?(function(i,f,y,s){s===void 0&&(s=y);var d=Object.getOwnPropertyDescriptor(f,y);(!d||("get"in d?!f.__esModule:d.writable||d.configurable))&&(d={enumerable:!0,get:function(){return f[y]}}),Object.defineProperty(i,s,d)}):(function(i,f,y,s){s===void 0&&(s=y),i[s]=f[y]})),l=H&&H.__setModuleDefault||(Object.create?(function(i,f){Object.defineProperty(i,"default",{enumerable:!0,value:f})}):function(i,f){i.default=f}),o=H&&H.__importStar||function(i){if(i&&i.__esModule)return i;var f={};if(i!=null)for(var y in i)y!=="default"&&Object.prototype.hasOwnProperty.call(i,y)&&r(f,i,y);return l(f,i),f};Object.defineProperty(e,"__esModule",{value:!0}),e.Visible=e.Suspense=e.Router=e.Link=e.Img=e.Helmet=void 0;var a=ce();Object.defineProperty(e,"Helmet",{enumerable:!0,get:function(){return a.Helmet}});var n=ot();Object.defineProperty(e,"Img",{enumerable:!0,get:function(){return n.Img}});var c=at();Object.defineProperty(e,"Link",{enumerable:!0,get:function(){return c.Link}}),e.Router=o(lt());var t=ct();Object.defineProperty(e,"Suspense",{enumerable:!0,get:function(){return t.Suspense}});var u=Te();Object.defineProperty(e,"Visible",{enumerable:!0,get:function(){return u.Visible}})})(H)),H}var de={},I={},qe;function dt(){if(qe)return I;qe=1,Object.defineProperty(I,"__esModule",{value:!0}),I.documentSSR=I.DocumentSSR=I.HTMLElementSSR=void 0;const e=Z();class r{constructor(n){this.isSelfClosing=!1,this.nodeType=null,this.tagName=n;const c=["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"];this.nodeType=1,c.indexOf(n)>=0?(this._ssr=`<${n} />`,this.isSelfClosing=!0):this._ssr=`<${n}></${n}>`}get outerHTML(){return this.toString()}get innerHTML(){return this.innerText}set innerHTML(n){this.innerText=n}get innerText(){var n;return((n=/(^<[^>]+>)(.+)?(<\/[a-z0-9]+>$|\/>$)/gm.exec(this._ssr))===null||n===void 0?void 0:n[2])||""}set innerText(n){const c=/(^<[^>]+>)(.+)?(<\/[a-z0-9]+>$|\/>$)/gm,t=(u,i,f,y)=>[i,n,y].join("");this._ssr=this._ssr.replace(c,t)}getAttribute(n){return null}get classList(){const n=this._ssr,c=/^<\w+.+(\sclass=")([^"]+)"/gm;return{add:t=>{this.setAttribute("class",t)},entries:{get length(){const t=c.exec(n);return t&&t[2]?t[2].split(" ").length:0}}}}toString(){return this._ssr}setAttributeNS(n,c,t){this.setAttribute(c,t)}setAttribute(n,c){const t=(i,f,y)=>`${f}${(0,e.escapeHtml)(n)}="${(0,e.escapeHtml)(c)}" ${y}`,u=(i,f,y)=>`${f} ${(0,e.escapeHtml)(n)}="${(0,e.escapeHtml)(c)}"${y}`;this.isSelfClosing?this._ssr=this._ssr.replace(/(^<[a-z0-9]+ )(.+)/gm,t):this._ssr=this._ssr.replace(/(^<[^>]+)(.+)/gm,u)}append(n){this.appendChild(n)}appendChild(n){const c=this._ssr.lastIndexOf("</");this._ssr=this._ssr.substring(0,c)+n+this._ssr.substring(c)}get children(){const n=/<([a-z0-9]+)((?!<\/\1).)*<\/\1>/gms,c=[];let t;for(;(t=n.exec(this.innerHTML))!==null;)c.push(t[0].replace(/[\s]+/gm," "));return c}addEventListener(n,c,t){}}I.HTMLElementSSR=r;class l{constructor(){this.body=this.createElement("body"),this.head=this.createElement("head")}createElement(n){return new r(n)}createElementNS(n,c){return this.createElement(c)}createTextNode(n){return(0,e.escapeHtml)(n)}querySelector(n){}}I.DocumentSSR=l;const o=()=>new l;return I.documentSSR=o,I}var He;function ke(){return He||(He=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.clearState=e.renderSSR=e.initSSR=void 0;const r=T(),l=dt(),o=je(),a=Z(),n={isWebComponent:f=>typeof f=="string"&&f.includes("-")&&_nano.customElements.has(f),renderWebComponent:(f,y,s,d)=>{const g=_nano.customElements.get(f),b=d({component:g,props:Object.assign(Object.assign({},y),{children:s})}).toString().match(/^<(?<tag>[a-z]+)>(.*)<\/\k<tag>>$/);if(b){let C=function(h,m,S,_){return h.replace(m,"")};const E=document.createElement(b[1]);return E.innerText=b[2],E.innerText=E.innerText.replace(/<\w+[^>]*(\s(on\w*)="[^"]*")/gm,C),E}else return null}};(()=>{const f=(0,a.detectSSR)()===!0?!0:void 0,y={pathname:"/"},s=f?(0,l.documentSSR)():window.document;globalThis._nano={isSSR:f,location:y,document:s,customElements:new Map,ssrTricks:n}})();const t=(f="/")=>{_nano.location={pathname:f},globalThis.document=_nano.document=(0,r.isSSR)()?(0,l.documentSSR)():window.document};e.initSSR=t;const u=(f,y={})=>{const{pathname:s,clearState:d=!0}=y;(0,e.initSSR)(s),d&&o._state.clear();const g=(0,r.render)(f,null,!0);return Array.isArray(g)?g.join(""):Array.from(g).join("")};e.renderSSR=u;const i=()=>{o._state.clear()};e.clearState=i})(de)),de}var z={},J={},ie={},ee={},Ie;function Ne(){return Ie||(Ie=1,Object.defineProperty(ee,"__esModule",{value:!0}),ee.MINI=void 0,ee.MINI=!1),ee}var he={},$e;function ht(){return $e||($e=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.build=e.evaluate=e.treeify=void 0;const r=Ne(),l=0,o=1,a=2,n=3,c=4,t=5,u=6,i=0,f=2,y=3,s=4,d=t,g=u,p=(C,h)=>{const m=_=>{let v="",w=null;const j=[],R=[];for(let L=1;L<_.length;L++){const M=_[L++],O=_[L]?h[_[L++]-1]:_[++L];M===y?v=O:M===s?(j.push(O),w=null):M===d?(w||(w=Object.create(null),j.push(w)),w[_[++L]]=[O]):M===g?w[_[++L]].push(O):M===f?R.push(m(O)):M===i&&R.push(O)}return{tag:v,props:j,children:R}},{children:S}=m(C);return S.length>1?S:S[0]};e.treeify=p;const b=(C,h,m,S)=>{let _;h[0]=0;for(let v=1;v<h.length;v++){const w=h[v++],j=h[v]?(h[0]|=w?1:2,m[h[v++]]):h[++v];w===y?S[0]=j:w===s?S[1]=Object.assign(S[1]||{},j):w===d?(S[1]=S[1]||{})[h[++v]]=j:w===g?S[1][h[++v]]+=`${j}`:w?(_=C.apply(j,(0,e.evaluate)(C,j,m,["",null])),S.push(_),j[0]?h[0]|=2:(h[v-2]=i,h[v]=_)):S.push(j)}return S};e.evaluate=b;const E=function(C,...h){const m=[C,...h],S=this;let _=o,v="",w="",j=[0],R,L;const M=O=>{_===o&&(O||(v=v.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?r.MINI?j.push(O?m[O]:v):j.push(i,O,v):_===n&&(O||v)?(r.MINI?j[1]=O?m[O]:v:j.push(y,O,v),_=a):_===a&&v==="..."&&O?r.MINI?j[2]=Object.assign(j[2]||{},m[O]):j.push(s,O,0):_===a&&v&&!O?r.MINI?(j[2]=j[2]||{})[v]=!0:j.push(d,0,!0,v):_>=t&&(r.MINI?_===t?((j[2]=j[2]||{})[L]=O?v?v+m[O]:m[O]:v,_=u):(O||v)&&(j[2][L]+=O?v+m[O]:v):((v||!O&&_===t)&&(j.push(_,0,v,L),_=u),O&&(j.push(_,O,0,L),_=u))),v=""};for(let O=0;O<C.length;O++){O&&(_===o&&M(),M(O));for(let x=0;x<C[O].length;x++)R=C[O][x],_===o?R==="<"?(M(),r.MINI?j=[j,"",null]:j=[j],_=n):v+=R:_===c?v==="--"&&R===">"?(_=o,v=""):v=R+v[0]:w?R===w?w="":v+=R:R==='"'||R==="'"?w=R:R===">"?(M(),_=o):_&&(R==="="?(_=t,L=v,v=""):R==="/"&&(_<t||C[O][x+1]===">")?(M(),_===n&&(j=j[0]),_=j,r.MINI?(j=j[0]).push(S(..._.slice(1))):(j=j[0]).push(f,0,_),_=l):R===" "||R==="	"||R===`
`||R==="\r"?(M(),_=a):v+=R),_===n&&v==="!--"&&(_=c,j=j[0])}return M(),r.MINI?j.length>2?j.slice(1):j[1]:j};e.build=E})(he)),he}var De;function ft(){if(De)return ie;De=1,Object.defineProperty(ie,"__esModule",{value:!0});const e=Ne(),r=ht(),l=new Map,o=function(a){let n=l.get(this);return n||(n=new Map,l.set(this,n)),n=(0,r.evaluate)(this,n.get(a)||(n.set(a,n=(0,r.build)(a)),n),arguments,[]),n.length>1?n:n[0]};return ie.default=e.MINI?r.build:o,ie}var Ve;function pt(){if(Ve)return J;Ve=1;var e=J&&J.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(J,"__esModule",{value:!0});const r=e(ft());return J.default=r.default,J}var Ue;function mt(){if(Ue)return z;Ue=1;var e=z&&z.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(z,"__esModule",{value:!0}),z.jsx=void 0;const r=T(),o=e(pt()).default.bind(r.h);return z.jsx=o,z}var te={},ze;function _t(){if(ze)return te;ze=1,Object.defineProperty(te,"__esModule",{value:!0}),te.hydrateLazy=void 0;const e=T(),r=Te(),l=(o,a=null,n=!0)=>{const c=(0,e.h)(r.Visible,null,o);return(0,e.hydrate)(c,a,n)};return te.hydrateLazy=l,te}var ne={},Fe;function gt(){if(Fe)return ne;Fe=1,Object.defineProperty(ne,"__esModule",{value:!0}),ne.Store=void 0;const e=T();class r{constructor(o,a="",n="memory"){if(this._listeners=new Map,(0,e.isSSR)()&&(n="memory"),this._id=a,this._storage=n,this._state=this._prevState=o,n==="memory"||!n)return;const c=n==="local"?localStorage:sessionStorage,t=c.getItem(this._id);t?this._state=this._prevState=JSON.parse(t):c.setItem(this._id,JSON.stringify(o))}persist(o){if(this._storage==="memory")return;(this._storage==="local"?localStorage:sessionStorage).setItem(this._id,JSON.stringify(o))}clear(){this._state=this._prevState=void 0,this._storage==="local"?localStorage.removeItem(this._id):this._storage==="session"&&sessionStorage.removeItem(this._id)}setState(o){this.state=o}set state(o){this._prevState=this._state,this._state=o,this.persist(o),this._listeners.forEach(a=>{a(this._state,this._prevState)})}get state(){return this._state}use(){const o=Math.random().toString(36).substring(2,9),a=this;return{get state(){return a.state},setState:n=>{this.state=n},subscribe:n=>{this._listeners.set(o,n)},cancel:()=>{this._listeners.has(o)&&this._listeners.delete(o)}}}}return ne.Store=r,ne}var F={},Be;function yt(){if(Be)return F;Be=1,Object.defineProperty(F,"__esModule",{value:!0}),F.useContext=F.createContext=void 0;const e=l=>{let o=l;return{Provider:a=>(a.value&&(o=a.value),a.children),Consumer:a=>({component:a.children[0](o),props:Object.assign(Object.assign({},a),{context:o})}),get:()=>o,set:a=>o=a}};F.createContext=e;const r=l=>{const o=l;if(o&&typeof o.get=="function")return o.get()};return F.useContext=r,F}var B={},xe;function bt(){if(xe)return B;xe=1;var e=B&&B.__rest||function(c,t){var u={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&t.indexOf(i)<0&&(u[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,i=Object.getOwnPropertySymbols(c);f<i.length;f++)t.indexOf(i[f])<0&&Object.prototype.propertyIsEnumerable.call(c,i[f])&&(u[i[f]]=c[i[f]]);return u};Object.defineProperty(B,"__esModule",{value:!0}),B.withStyles=void 0;const r=T(),l=$(),o=ue(),a=ce(),n=(...c)=>t=>class extends l.Component{render(){const u=this.props,{children:i}=u,f=e(u,["children"]),y=[];c.forEach(d=>{var g;if(typeof d=="string")y.push((0,r.h)(a.Helmet,null,(0,r.h)("style",null,d)));else if(typeof d=="function"){const p=d();typeof p=="string"&&y.push((0,r.h)(a.Helmet,null,(0,r.h)("style",null,p)))}else if(typeof d=="object"){const p=(g=d.toString)===null||g===void 0?void 0:g.call(d);typeof p=="string"&&y.push((0,r.h)(a.Helmet,null,(0,r.h)("style",null,p)))}});const s=i&&i.length>0?(0,r.h)(t,Object.assign({},f),i):(0,r.h)(t,Object.assign({},this.props));return(0,r.h)(o.Fragment,null,...y,s)}};return B.withStyles=n,B}var re={},Je;function vt(){if(Je)return re;Je=1,Object.defineProperty(re,"__esModule",{value:!0}),re.defineAsCustomElements=void 0;const e=T(),r=(o,a,n=[],c={})=>{/^[a-zA-Z0-9]+-[a-zA-Z0-9]+$/.test(a)?_nano.customElements.set(a,o):console.log(`Error: WebComponent name "${a}" is invalid.`)},l=function(o,a,n,c){if((0,e.isSSR)()){r(o,a,n);return}customElements.define(a,class extends HTMLElement{constructor(){super(),c?(this.attachShadow(c),this.$root=this.shadowRoot):this.$root=this;let t;const u=this.buildEl((0,e._render)({component:o,props:{ref:i=>t=i,children:Array.from(this.children).map(i=>(0,e.render)(i))}}));this.component=t,this.isFunctionalComponent=!o.isClass,this.functionalComponentsProps={},this.appendEl(u),this.isFunctionalComponent||(this.component.updatePropsValue=(i,f)=>{this.component.props||(this.component.props={}),this.component.props[i]=f,this.component[i]=f})}static get observedAttributes(){return n}buildEl(t){return(0,e.h)(this.shadowRoot?"div":"template",null,t)}appendEl(t){this.shadowRoot?this.$root.append(t):this.$root.append(...t.childNodes)}removeChildren(){var t;if(this.$root){const u=Array.from((t=this.$root)===null||t===void 0?void 0:t.children)||[];for(const i of u)i.remove()}}attributeChangedCallback(t,u,i){if(!this.isFunctionalComponent)this.component.updatePropsValue(t,i),this.component.update();else{this.removeChildren(),this.functionalComponentsProps[t]=i;const f=this.buildEl((0,e._render)({component:o,props:Object.assign({children:[],ref:y=>this.component=y},this.functionalComponentsProps)}));this.appendEl(f)}}})};return re.defineAsCustomElements=l,re}var We;function St(){return We||(We=1,(function(e){var r=D&&D.__createBinding||(Object.create?(function(C,h,m,S){S===void 0&&(S=m);var _=Object.getOwnPropertyDescriptor(h,m);(!_||("get"in _?!h.__esModule:_.writable||_.configurable))&&(_={enumerable:!0,get:function(){return h[m]}}),Object.defineProperty(C,S,_)}):(function(C,h,m,S){S===void 0&&(S=m),C[S]=h[m]})),l=D&&D.__exportStar||function(C,h){for(var m in C)m!=="default"&&!Object.prototype.hasOwnProperty.call(h,m)&&r(h,C,m)};Object.defineProperty(e,"__esModule",{value:!0}),e.VERSION=e.printVersion=e.defineAsCustomElements=e.withStyles=e.useContext=e.createContext=e.Store=e.Fragment=e.renderSSR=e.task=e.nodeToString=e.hydrateLazy=e.jsx=e.isSSR=e.Component=e.tick=e.hydrate=e.render=e.h=void 0;var o=T();Object.defineProperty(e,"h",{enumerable:!0,get:function(){return o.h}}),Object.defineProperty(e,"render",{enumerable:!0,get:function(){return o.render}}),Object.defineProperty(e,"hydrate",{enumerable:!0,get:function(){return o.hydrate}}),Object.defineProperty(e,"tick",{enumerable:!0,get:function(){return o.tick}});var a=$();Object.defineProperty(e,"Component",{enumerable:!0,get:function(){return a.Component}}),l(ut(),e);const n=T();Object.defineProperty(e,"isSSR",{enumerable:!0,get:function(){return n.isSSR}});const c=ke();e.default={h:n.h,render:n.render,hydrate:n.hydrate,renderSSR:c.renderSSR,isSSR:n.isSSR};var t=mt();Object.defineProperty(e,"jsx",{enumerable:!0,get:function(){return t.jsx}});var u=_t();Object.defineProperty(e,"hydrateLazy",{enumerable:!0,get:function(){return u.hydrateLazy}});var i=Z();Object.defineProperty(e,"nodeToString",{enumerable:!0,get:function(){return i.nodeToString}}),Object.defineProperty(e,"task",{enumerable:!0,get:function(){return i.task}});var f=ke();Object.defineProperty(e,"renderSSR",{enumerable:!0,get:function(){return f.renderSSR}});var y=ue();Object.defineProperty(e,"Fragment",{enumerable:!0,get:function(){return y.Fragment}});var s=gt();Object.defineProperty(e,"Store",{enumerable:!0,get:function(){return s.Store}});var d=yt();Object.defineProperty(e,"createContext",{enumerable:!0,get:function(){return d.createContext}}),Object.defineProperty(e,"useContext",{enumerable:!0,get:function(){return d.useContext}});var g=bt();Object.defineProperty(e,"withStyles",{enumerable:!0,get:function(){return g.withStyles}});var p=vt();Object.defineProperty(e,"defineAsCustomElements",{enumerable:!0,get:function(){return p.defineAsCustomElements}});var b=Z();Object.defineProperty(e,"printVersion",{enumerable:!0,get:function(){return b.printVersion}});var E=be();Object.defineProperty(e,"VERSION",{enumerable:!0,get:function(){return E.VERSION}})})(D)),D}var oe=St();const Ge=it(oe);class jt extends oe.Component{render(){return P("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px 16px",marginBottom:"12px",borderRadius:"8px",backgroundColor:"var(--color-neutral-background)",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:P("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[this.props.icon&&P("span",{style:{fontSize:"20px"},children:this.props.icon}),P("div",{children:[P("div",{style:{fontWeight:600,fontSize:"14px",marginBottom:"4px"},children:this.props.title}),P("div",{style:{fontSize:"12px",color:"var(--color-neutral-text)",opacity:.8},children:this.props.description})]})]})})}}class Ot extends oe.Component{render(){const{visible:r,onClose:l,items:o}=this.props;return P("div",{style:{display:r?"flex":"none",position:"fixed",top:0,left:0,width:"100%",height:"100%",alignItems:"center",justifyContent:"center",background:"rgba(0,0,0,0.5)",zIndex:9999},children:P("div",{style:{background:"var(--color-neutral-background)",padding:"20px",borderRadius:"8px",position:"relative",color:"var(--color-neutral-content-strong)",height:"85%",width:"85%"},children:[P("span",{style:{position:"absolute",top:"5px",right:"10px",cursor:"pointer",fontWeight:"bold"},onClick:l,children:"×"}),P("h2",{children:"ReadIt Settings"}),P("div",{id:"settings-tile-container",children:o.map(a=>P(jt,{title:a.title,description:a.description}))})]})})}}class wt extends oe.Component{render(){const{onClick:r}=this.props;return P("span",{"data-part":"create",class:"contents",children:P("create-post-entry-point-wrapper",{children:P("faceplate-tracker",{class:"nd:visible contents",source:"post_composer",action:"click",noun:"create_post",children:P("rpl-tooltip",{style:"--rpl-z-index-tooltip:1001",class:"nd:visible contents",placement:"bottom",appearance:"inverted",trigger:"hover focus-visible",distance:"8",children:[P("a",{rpl:"","aria-label":"ReadIt Settings",class:`no-underline hover:no-underline active:no-underline
                        button-medium px-[var(--rem8)]
                        button-plain icon items-center justify-center
                        button inline-flex`,id:"settings-open",onClick:r,children:[P("span",{class:"flex items-center justify-center",children:P("span",{class:"flex",children:P("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"#e3e3e3",children:P("path",{d:"m370-80-16-128q-13-5-24.5-12T307-235l-119 50L78-375l103-78q-1-7-1-13.5v-27q0-6.5 1-13.5L78-585l110-190 119 50q11-8 23-15t24-12l16-128h220l16 128q13 5 24.5 12t22.5 15l119-50 110 190-103 78q1 7 1 13.5v27q0 6.5-2 13.5l103 78-110 190-118-50q-11 8-23 15t-24 12L590-80H370Zm70-80h79l14-106q31-8 57.5-23.5T639-327l99 41 39-68-86-65q5-14 7-29.5t2-31.5q0-16-2-31.5t-7-29.5l86-65-39-68-99 42q-22-23-48.5-38.5T533-694l-13-106h-79l-14 106q-31 8-57.5 23.5T321-633l-99-41-39 68 86 64q-5 15-7 30t-2 32q0 16 2 31t7 30l-86 65 39 68 99-42q22 23 48.5 38.5T427-266l13 106Zm42-180q58 0 99-41t41-99q0-58-41-99t-99-41q-59 0-99.5 41T342-480q0 58 40.5 99t99.5 41Zm-2-140Z"})})})}),P("faceplate-screen-reader-content",{children:"ReadIt Settings"})]}),P("span",{slot:"content",children:"ReadIt Settings"})]})})})})}}class Ct{constructor(r){this.readit=r,this.visible=!1,this.tiles=[],this.isSettingsVisible=()=>document.getElementById("settings-open")!==null,this.open=()=>{this.visible=!0,this.render()},this.close=()=>{this.visible=!1,this.render()},this.toggle=()=>{this.visible=!this.visible,this.render()},this.modalContainer=document.createElement("div"),document.body.appendChild(this.modalContainer),this.injectButton(),this.patchRenderMethod(),this.render()}injectButton(){const r=document.querySelector("body > shreddit-app > reddit-header-large > reddit-header-action-items > header > nav > div.ps-lg.gap-xs.flex.items-center.justify-end > div:nth-child(2)");if(!r||this.isSettingsVisible())return;const l=document.createElement("div");r.appendChild(l),Ge.render(P(wt,{onClick:this.open}),l)}patchRenderMethod(){const r=document.querySelector("shreddit-app");if(!r)return;const l=r.__proto__;if(l.__readitPatched)return;const o=l.render;l.render=function(...a){const n=o.call(this,...a);return this.readit?.settings?.injectButton?.(),n},l.__readitPatched=!0}registerSettingsTile(r){this.tiles.push(r),this.render()}render(){Ge.render(P(Ot,{visible:this.visible,onClose:this.close,items:this.tiles}),this.modalContainer)}}class Pt{constructor(){this.version=GM_info.script.version,this.posts=new Xe(this),this.settings=new Ct(this),this.plugins=new Ke(this),this.plugins.loadPlugins(),this.settings.registerSettingsTile({title:"ReadIt Version",description:this.version})}}const Rt=new Pt;unsafeWindow.readit=Rt})();
