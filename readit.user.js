// ==UserScript==
// @name         ReadIt
// @namespace    http://github.com/tralwdwd/
// @version      1.0.0
// @description  A userscript for Reddit Web with plugin support.
// @author       tralwdwd
// @match        https://*.reddit.com/*
// @icon         https://www.redditstatic.com/desktop2x/img/favicon/apple-icon-76x76.png
// @grant        GM.xmlHttpRequest
// @grant        unsafeWindow
// ==/UserScript==

// This code has been bundled, for source code go to https://github.com/tralwdwd/readit


(function(){"use strict";class Ye{constructor(t){this.readit=t,this.selector="shreddit-post, shreddit-ad-post",this.postCallbacks=[],this._queuedPosts=new Set,this._rafScheduled=!1,this.registerOnPostsLoaded=o=>{this.postCallbacks.push(o),this._callbackInitialScan()},new MutationObserver(o=>{for(const a of o)for(const r of Array.from(a.addedNodes))r.nodeType===1&&r instanceof HTMLElement&&(r.matches(this.selector)&&this._queuedPosts.add(r),r.querySelectorAll(this.selector).forEach(n=>this._queuedPosts.add(n)));this._scheduleEmit()}).observe(document.body,{childList:!0,subtree:!0})}_callbackInitialScan(){const t=document.querySelectorAll(this.selector);t.length>0&&this._emitPosts(Array.from(t))}_scheduleEmit(){this._rafScheduled||(this._rafScheduled=!0,window.requestAnimationFrame(()=>{this._queuedPosts.size>0&&(this._emitPosts(Array.from(this._queuedPosts)),this._queuedPosts.clear()),this._rafScheduled=!1}))}_emitPosts(t){this.postCallbacks.forEach(l=>l(t))}}const Ke=(e=>e)({name:"ReadIt Adblock",description:"Builtin plugin to remove ads from the website.",version:"1.0.0",onLoad:e=>{e.posts.registerLoadCallback(t=>{t.forEach(l=>{l.matches("shreddit-ad-post")&&l.remove()})})}}),Qe=Object.freeze(Object.defineProperty({__proto__:null,default:Ke},Symbol.toStringTag,{value:"Module"}));async function et(e){const t=await new Promise((a,r)=>{GM.xmlHttpRequest({method:"GET",url:e,onload:c=>a(c.responseText),onerror:c=>r(c)})}),l=new Blob([t],{type:"text/javascript"}),o=URL.createObjectURL(l);try{return await import(o)}finally{URL.revokeObjectURL(o)}}function tt(e){return{registerLoadCallback:t=>e.registerOnPostsLoaded(t)}}function nt(e){return{registerSettingsTile:t=>e.registerSettingsTile(t)}}function me(e){return{posts:tt(e.posts),settings:nt(e.settings)}}class rt{constructor(t){this.readit=t,this.unloadedPluginList=[],this.loadedPluginList=[],localStorage.getItem("plugins")==null&&localStorage.setItem("plugins","[]");const l=JSON.parse(localStorage.getItem("plugins"));this.unloadedPluginList=l}get pluginList(){return this.loadedPluginList}async loadPlugins(){console.log(this.unloadedPluginList),this.loadBuiltins(),this.unloadedPluginList.forEach(async t=>{try{await this.loadPlugin(t.url)}catch(l){console.error("Plugin execution failed, URL:",t.url,l)}})}loadBuiltins(){const t=Object.assign({"./builtin/ReadItAdBlock/index.ts":Qe});for(const l of Object.values(t)){const o=l.default,a=me(this.readit);this.loadedPluginList.push(o),o.onLoad(a)}}async loadPlugin(t){const l=me(this.readit);try{const a=(await et(t)).default;this.loadedPluginList.push(a),a.onLoad(l)}catch(o){console.error("Failed to load plugin:",o)}}addPlugin(t){localStorage.getItem("plugins")==null&&localStorage.setItem("plugins","[]");const l=JSON.parse(localStorage.getItem("plugins"));l.push({url:t}),localStorage.setItem("plugins",JSON.stringify(l)),alert("New Plugins require a reload!")}}const N=()=>typeof _nano<"u"&&_nano.isSSR===!0,st=Promise.prototype.then.bind(Promise.resolve()),it=e=>{let t=0;for(let l=0;l<e.length;l++){const o=e.charCodeAt(l);t=(t<<5)-t+o,t|=0}return Math.abs(t).toString(32)},se=(e,t,l=!0)=>{if(!Array.isArray(t)){se(e,[t],l);return}typeof t=="object"&&(t=Array.prototype.slice.call(t)),t.forEach(o=>{if(Array.isArray(o))se(e,o,l);else{const a=q(o);typeof a<"u"&&(Array.isArray(a)?se(e,a,l):N()&&!l?e.appendChild(a.nodeType==null?a.toString():a):e.appendChild(a.nodeType==null?document.createTextNode(a.toString()):a))}})},ot=e=>{const t=e.children[0],l=t.attributes;if(N())return t;const o=ge("svg");for(let a=l.length-1;a>=0;a--)o.setAttribute(l[a].name,l[a].value);return o.innerHTML=t.innerHTML,o},q=e=>{if(e===null||e===!1||typeof e>"u")return[];if(typeof e=="string"||typeof e=="number")return e.toString();if(e.tagName&&e.tagName.toLowerCase()==="svg")return ot({children:[e]});if(e.tagName||e&&e.nodeType===3)return e;if(e&&e.component&&e.component.isClass)return _e(e);if(e.isClass)return _e({component:e,props:{}});if(e.component&&typeof e.component=="function")return at(e);if(Array.isArray(e))return e.map(t=>q(t)).flat();if(typeof e=="function"&&!e.isClass)return q(e());if(e.component&&e.component.tagName&&typeof e.component.tagName=="string"||Array.isArray(e.component)||e.component)return q(e.component);if(typeof e=="object")return[];console.warn("Something unexpected happened with:",e)},at=e=>{const{component:t,props:l}=e;return q(t(l))},_e=e=>{const{component:t,props:l}=e,o=it(t.toString());t.prototype._getHash=()=>o;const a=new t(l);N()||a.willMount();let r=a.render();return r=q(r),a.elements=r,l&&l.ref&&l.ref(a),N()||st(()=>{a._didMount()}),r},ge=e=>document.createElementNS("http://www.w3.org/2000/svg",e),lt=(e,t={},...l)=>{if(t&&t.children&&(Array.isArray(l)?Array.isArray(t.children)?l=[...t.children,...l]:l.push(t.children):Array.isArray(t.children)?l=t.children:l=[t.children]),N()&&_nano.ssrTricks.isWebComponent(e)){const n=_nano.ssrTricks.renderWebComponent(e,t,l,q);return n===null?`ERROR: "<${e} />"`:n}if(typeof e!="string")return{component:e,props:Object.assign(Object.assign({},t),{children:l})};try{if(N()&&typeof e=="string"&&!document)throw new Error("document is not defined")}catch(n){console.log("ERROR:",n.message,`
 > Please read: https://github.com/nanojsx/nano/issues/106`)}let o;const a=e==="svg"?ge("svg"):document.createElement(e),r=(n,u)=>u.indexOf("on")!==0?!1:n._ssr?!0:typeof n[u]=="object"||typeof n[u]=="function";for(const n in t){if(n==="style"&&typeof t[n]=="object"){const u=Object.keys(t[n]).map(i=>`${i}:${t[n][i]}`).join(";").replace(/[A-Z]/g,i=>`-${i.toLowerCase()}`);t[n]=`${u};`}if(n==="ref")o=t[n];else if(r(a,n.toLowerCase()))a.addEventListener(n.toLowerCase().substring(2),u=>t[n](u));else if(n==="dangerouslySetInnerHTML"&&t[n].__html)if(N())a.innerHTML=t[n].__html;else{const u=document.createElement("fragment");u.innerHTML=t[n].__html,a.appendChild(u)}else if(n==="innerHTML"&&t[n].__dangerousHtml)if(N())a.innerHTML=t[n].__dangerousHtml;else{const u=document.createElement("fragment");u.innerHTML=t[n].__dangerousHtml,a.appendChild(u)}else/^className$/i.test(n)?a.setAttribute("class",t[n]):typeof t[n]<"u"&&a.setAttribute(n,t[n])}const c=!["noscript","script","style"].includes(e);return se(a,l,c),o&&o(a),a};var ct=function(e,t){var l={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(l[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(l[o[a]]=e[o[a]]);return l};const C=function(e,t){let{children:l=[]}=t,o=ct(t,["children"]);return Array.isArray(l)||(l=[l]),lt(e,o,...l)};function ut(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var D={},ae={},ye;function T(){return ye||(ye=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.h=e._render=e.hydrate=e.render=e.appendChildren=e.strToHash=e.removeAllChildNodes=e.tick=e.isSSR=void 0;const t=()=>typeof _nano<"u"&&_nano.isSSR===!0;e.isSSR=t,e.tick=Promise.prototype.then.bind(Promise.resolve());const l=s=>{for(;s.firstChild;)s.removeChild(s.firstChild)};e.removeAllChildNodes=l;const o=s=>{let d=0;for(let g=0;g<s.length;g++){const p=s.charCodeAt(g);d=(d<<5)-d+p,d|=0}return Math.abs(d).toString(32)};e.strToHash=o;const a=(s,d,g=!0)=>{if(!Array.isArray(d)){(0,e.appendChildren)(s,[d],g);return}typeof d=="object"&&(d=Array.prototype.slice.call(d)),d.forEach(p=>{if(Array.isArray(p))(0,e.appendChildren)(s,p,g);else{const b=(0,e._render)(p);typeof b<"u"&&(Array.isArray(b)?(0,e.appendChildren)(s,b,g):(0,e.isSSR)()&&!g?s.appendChild(b.nodeType==null?b.toString():b):s.appendChild(b.nodeType==null?document.createTextNode(b.toString()):b))}})};e.appendChildren=a;const r=s=>{const d=s.children[0],g=d.attributes;if((0,e.isSSR)())return d;const p=f("svg");for(let b=g.length-1;b>=0;b--)p.setAttribute(g[b].name,g[b].value);return p.innerHTML=d.innerHTML,p},c=(s,d=null,g=!0)=>{let p=(0,e._render)(s);return Array.isArray(p)&&(p=p.map(b=>(0,e._render)(b)),p.length===1&&(p=p[0])),d?(g&&(0,e.removeAllChildNodes)(d),p&&d.id&&d.id===p.id&&d.parentElement?d.parentElement.replaceChild(p,d):Array.isArray(p)?p.forEach(b=>{(0,e.appendChildren)(d,(0,e._render)(b))}):(0,e.appendChildren)(d,(0,e._render)(p)),d):(0,e.isSSR)()&&!Array.isArray(p)?[p]:p};e.render=c,e.hydrate=e.render;const n=s=>{if(s===null||s===!1||typeof s>"u")return[];if(typeof s=="string"||typeof s=="number")return s.toString();if(s.tagName&&s.tagName.toLowerCase()==="svg")return r({children:[s]});if(s.tagName||s&&s.nodeType===3)return s;if(s&&s.component&&s.component.isClass)return i(s);if(s.isClass)return i({component:s,props:{}});if(s.component&&typeof s.component=="function")return u(s);if(Array.isArray(s))return s.map(d=>(0,e._render)(d)).flat();if(typeof s=="function"&&!s.isClass)return(0,e._render)(s());if(s.component&&s.component.tagName&&typeof s.component.tagName=="string"||Array.isArray(s.component)||s.component)return(0,e._render)(s.component);if(typeof s=="object")return[];console.warn("Something unexpected happened with:",s)};e._render=n;const u=s=>{const{component:d,props:g}=s;return(0,e._render)(d(g))},i=s=>{const{component:d,props:g}=s,p=(0,e.strToHash)(d.toString());d.prototype._getHash=()=>p;const b=new d(g);(0,e.isSSR)()||b.willMount();let E=b.render();return E=(0,e._render)(E),b.elements=E,g&&g.ref&&g.ref(b),(0,e.isSSR)()||(0,e.tick)(()=>{b._didMount()}),E},f=s=>document.createElementNS("http://www.w3.org/2000/svg",s),y=(s,d={},...g)=>{if(d&&d.children&&(Array.isArray(g)?Array.isArray(d.children)?g=[...d.children,...g]:g.push(d.children):Array.isArray(d.children)?g=d.children:g=[d.children]),(0,e.isSSR)()&&_nano.ssrTricks.isWebComponent(s)){const h=_nano.ssrTricks.renderWebComponent(s,d,g,e._render);return h===null?`ERROR: "<${s} />"`:h}if(typeof s!="string")return{component:s,props:Object.assign(Object.assign({},d),{children:g})};try{if((0,e.isSSR)()&&typeof s=="string"&&!document)throw new Error("document is not defined")}catch(h){console.log("ERROR:",h.message,`
 > Please read: https://github.com/nanojsx/nano/issues/106`)}let p;const b=s==="svg"?f("svg"):document.createElement(s),E=(h,m)=>m.indexOf("on")!==0?!1:h._ssr?!0:typeof h[m]=="object"||typeof h[m]=="function";for(const h in d){if(h==="style"&&typeof d[h]=="object"){const m=Object.keys(d[h]).map(S=>`${S}:${d[h][S]}`).join(";").replace(/[A-Z]/g,S=>`-${S.toLowerCase()}`);d[h]=`${m};`}if(h==="ref")p=d[h];else if(E(b,h.toLowerCase()))b.addEventListener(h.toLowerCase().substring(2),m=>d[h](m));else if(h==="dangerouslySetInnerHTML"&&d[h].__html)if((0,e.isSSR)())b.innerHTML=d[h].__html;else{const m=document.createElement("fragment");m.innerHTML=d[h].__html,b.appendChild(m)}else if(h==="innerHTML"&&d[h].__dangerousHtml)if((0,e.isSSR)())b.innerHTML=d[h].__dangerousHtml;else{const m=document.createElement("fragment");m.innerHTML=d[h].__dangerousHtml,b.appendChild(m)}else/^className$/i.test(h)?b.setAttribute("class",d[h]):typeof d[h]<"u"&&b.setAttribute(h,d[h])}const P=!["noscript","script","style"].includes(s);return(0,e.appendChildren)(b,g,P),p&&p(b),b};e.h=y})(ae)),ae}var W={},A={},G={},be;function ve(){return be||(be=1,Object.defineProperty(G,"__esModule",{value:!0}),G.VERSION=void 0,G.VERSION="0.1.0"),G}var Se;function Z(){if(Se)return A;Se=1,Object.defineProperty(A,"__esModule",{value:!0}),A.printVersion=A.escapeHtml=A.onNodeRemove=A.detectSSR=A.nodeToString=A.task=void 0;const e=ve(),t=u=>setTimeout(u,0);A.task=t;const l=u=>{const i=document.createElement("div");return i.appendChild(u.cloneNode(!0)),i.innerHTML};A.nodeToString=l;const o=()=>{const u=typeof Deno<"u",i=typeof window<"u";return typeof _nano<"u"&&_nano.isSSR||u||!i};A.detectSSR=o;function a(u,i){return!!u&&(u===i||a(u.parentNode,i))}const r=(u,i)=>{let f=new MutationObserver(y=>{y.forEach(s=>{s.removedNodes.forEach(d=>{a(u,d)&&(i(),f&&(f.disconnect(),f=void 0))})})});return f.observe(document,{childList:!0,subtree:!0}),f};A.onNodeRemove=r;const c=u=>u&&typeof u=="string"?u.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):u;A.escapeHtml=c;const n=()=>{const u=`Powered by nano JSX v${e.VERSION}`;console.log(`%c %c %c %c %c ${u} %c http://nanojsx.io`,"background: #ff0000","background: #ffff00","background: #00ff00","background: #00ffff","color: #fff; background: #000000;","background: none")};return A.printVersion=n,A}var le={},je;function Oe(){return je||(je=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e._clearState=e._state=void 0,e._state=new Map;const t=()=>{e._state.clear()};e._clearState=t})(le)),le}var we;function $(){if(we)return W;we=1,Object.defineProperty(W,"__esModule",{value:!0}),W.Component=void 0;const e=Z(),t=T(),l=Oe();class o{constructor(r){this._elements=[],this._skipUnmount=!1,this._hasUnmounted=!1,this.props=r||{},this.id=this._getHash()}static get isClass(){return!0}get isClass(){return!0}setState(r,c=!1){typeof r=="object"&&r!==null&&this.state!==void 0?this.state=Object.assign(Object.assign({},this.state),r):this.state=r,c&&this.update()}set state(r){l._state.set(this.id,r)}get state(){return l._state.get(this.id)}set initState(r){this.state===void 0&&(this.state=r)}get elements(){return this._elements||[]}set elements(r){Array.isArray(r)||(r=[r]),r.forEach(c=>{this._elements.push(c)})}_addNodeRemoveListener(){/^[^{]+{\s+}$/gm.test(this.didUnmount.toString())||(0,e.onNodeRemove)(this.elements[0],()=>{this._skipUnmount||this._didUnmount()})}_didMount(){this._addNodeRemoveListener(),this.didMount()}_willUpdate(){this.willUpdate()}_didUpdate(){this.didUpdate()}_didUnmount(){this._hasUnmounted||(this.didUnmount(),this._hasUnmounted=!0)}willMount(){}didMount(){}willUpdate(){}didUpdate(){}didUnmount(){}render(r){}update(r){this._skipUnmount=!0,this._willUpdate();const c=[...this.elements];this._elements=[];let n=this.render(r);n=(0,t._render)(n),this.elements=n;const u=c[0].parentElement;u||console.warn("Component needs a parent element to get updated!"),this.elements.forEach(i=>{u&&u.insertBefore(i,c[0])}),c.forEach(i=>{this.elements.includes(i)||(i.remove(),i=null)}),this._addNodeRemoveListener(),(0,t.tick)(()=>{this._skipUnmount=!1,this.elements[0].isConnected?this._didUpdate():this._didUnmount()})}_getHash(){}}return W.Component=o,W}var k={},X={},Pe;function ce(){if(Pe)return X;Pe=1,Object.defineProperty(X,"__esModule",{value:!0}),X.Helmet=void 0;const e=$(),t=T();class l extends Map{toString(){let r="";for(const[c,n]of this)r+=` ${c}="${n}"`;return r.trim()}}class o extends e.Component{static SSR(r){var c,n;const u=/(<helmet\b[^>]*>)((.|\r|\n)*?)(<\/helmet>)/gm,i=[],f=[],y={html:new l,body:new l};if(typeof document<"u"&&document.head){let g=[];g=[].slice.call(document.head.children);for(let p=0;p<g.length;p++)i.indexOf(g[p])===-1&&i.push(g[p])}let s;for(;(s=u.exec(r))!==null;){const g=s[1];let p=s[2];const b=/<html\s([^>]+)><\/html>/gm,E=/<body\s([^>]+)><\/body>/gm,P=/(\w+)="([^"]+)"/gm;let h=null;(c=r.match(b))===null||c===void 0||c.forEach(S=>{for(p=p.replace(S,"");(h=P.exec(S))!==null;)y.html.set(h[1],h[2])}),(n=r.match(E))===null||n===void 0||n.forEach(S=>{for(p=p.replace(S,"");(h=P.exec(S))!==null;)y.body.set(h[1],h[2])});const m=g.includes('data-placement="head"');m&&!i.includes(p)?i.push(p):!m&&!f.includes(p)&&f.push(p)}return{body:r.replace(u,""),head:i,footer:f,attributes:y}}didMount(){this.props.children.forEach(r=>{var c,n,u,i;if(!(r instanceof HTMLElement))return;const f=this.props.footer?document.body:document.head,y=r.tagName;let s=[];s.push(r.innerText);for(let p=0;p<r.attributes.length;p++)s.push((c=r.attributes.item(p))===null||c===void 0?void 0:c.name.toLowerCase()),s.push((n=r.attributes.item(p))===null||n===void 0?void 0:n.value.toLowerCase());if(y==="HTML"||y==="BODY"){const p=document.getElementsByTagName(y)[0];for(let b=1;b<s.length;b+=2)p.setAttribute(s[b],s[b+1]);return}else if(y==="TITLE"){const p=document.getElementsByTagName("TITLE");if(p.length>0){const b=r;p[0].text=b.text}else{const b=(0,t.h)("title",null,r.innerHTML);(0,t.appendChildren)(f,[b],!1)}return}let d=!1;s=s.sort();const g=document.getElementsByTagName(y);for(let p=0;p<g.length;p++){let b=[];b.push(g[p].innerText);for(let E=0;E<g[p].attributes.length;E++)b.push((u=g[p].attributes.item(E))===null||u===void 0?void 0:u.name.toLowerCase()),b.push((i=g[p].attributes.item(E))===null||i===void 0?void 0:i.value.toLowerCase());b=b.sort(),s.length>0&&b.length>0&&JSON.stringify(s)===JSON.stringify(b)&&(d=!0)}d||(0,t.appendChildren)(f,[r],!1)})}render(){const r=this.props.footer?"footer":"head";return(0,t.isSSR)()?(0,t.h)("helmet",{"data-ssr":!0,"data-placement":r},this.props.children):[]}}return X.Helmet=o,X}var V={},Ce;function dt(){if(Ce)return V;Ce=1;var e=V&&V.__rest||function(a,r){var c={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&r.indexOf(n)<0&&(c[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,n=Object.getOwnPropertySymbols(a);u<n.length;u++)r.indexOf(n[u])<0&&Object.prototype.propertyIsEnumerable.call(a,n[u])&&(c[n[u]]=a[n[u]]);return c};Object.defineProperty(V,"__esModule",{value:!0}),V.Img=void 0;const t=$(),l=T();class o extends t.Component{constructor(r){super(r);const{src:c,key:n}=r;this.id=`${(0,l.strToHash)(c)}-${(0,l.strToHash)(JSON.stringify(r))}`,n&&(this.id+=`key-${n}`),this.state||this.setState({isLoaded:!1,image:void 0})}didMount(){const r=this.props,{lazy:c=!0,placeholder:n,children:u,key:i,ref:f}=r,y=e(r,["lazy","placeholder","children","key","ref"]);if(typeof c=="boolean"&&c===!1)return;new IntersectionObserver((d,g)=>{d.forEach(p=>{p.isIntersecting&&(g.disconnect(),this.state.image=(0,l.h)("img",Object.assign({},y)),this.state.image.complete?(this.state.isLoaded=!0,this.update()):this.state.image.onload=()=>{this.state.isLoaded=!0,this.update()})})},{threshold:[0,1]}).observe(this.elements[0])}render(){const r=this.props,{src:c,placeholder:n,children:u,lazy:i=!0,key:f,ref:y}=r,s=e(r,["src","placeholder","children","lazy","key","ref"]);if(typeof i=="boolean"&&i===!1)return this.state.image=(0,l.h)("img",Object.assign({src:c},s)),this.state.image;if(this.state.isLoaded)return this.state.image;if(n&&typeof n=="string")return(0,l.h)("img",Object.assign({src:n},s));if(n&&typeof n=="function")return n();{const d={};s.width&&(d.width=`${s.width}px`),s.height&&(d.height=`${s.height}px`);const{width:g,height:p}=s,b=e(s,["width","height"]);return(0,l.h)("div",Object.assign({style:d},b))}}}return V.Img=o,V}var U={},Y={},Re;function ue(){if(Re)return Y;Re=1,Object.defineProperty(Y,"__esModule",{value:!0}),Y.Fragment=void 0;const e=t=>t.children;return Y.Fragment=e,Y}var Ee;function ht(){if(Ee)return U;Ee=1;var e=U&&U.__rest||function(c,n){var u={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&n.indexOf(i)<0&&(u[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,i=Object.getOwnPropertySymbols(c);f<i.length;f++)n.indexOf(i[f])<0&&Object.prototype.propertyIsEnumerable.call(c,i[f])&&(u[i[f]]=c[i[f]]);return u};Object.defineProperty(U,"__esModule",{value:!0}),U.Link=void 0;const t=$(),l=ce(),o=T(),a=ue();class r extends t.Component{prefetchOnHover(){this.elements[0].addEventListener("mouseover",()=>this.addPrefetch(),{once:!0})}prefetchOnVisible(){new IntersectionObserver((u,i)=>{u.forEach(f=>{f.isIntersecting&&(i.disconnect(),this.addPrefetch())})},{threshold:[0,1]}).observe(this.elements[0])}addPrefetch(){let n=!1;const u=document.getElementsByTagName("link");for(let i=0;i<u.length;i++)u[i].getAttribute("rel")==="prefetch"&&u[i].getAttribute("href")===this.props.href&&(n=!0);if(!n){const i=(0,o.h)("link",{rel:"prefetch",href:this.props.href,as:"document"});document.head.appendChild(i)}}didMount(){const{href:n,prefetch:u,delay:i=0,back:f=!1}=this.props;f&&this.elements[0].addEventListener("click",y=>{y.preventDefault();const s=y.target;s.href===document.referrer?window.history.back():window.location.href=s.href}),i>0&&this.elements[0].addEventListener("click",y=>{y.preventDefault(),setTimeout(()=>window.location.href=n,i)}),u&&(u==="hover"?this.prefetchOnHover():u==="visible"?this.prefetchOnVisible():this.addPrefetch())}render(){const n=this.props,{children:u,prefetch:i,back:f,ref:y}=n,s=e(n,["children","prefetch","back","ref"]);this.props.href||console.warn('Please add "href" to <Link>'),u.length!==1&&console.warn("Please add ONE child to <Link> (<Link>child</Link>)");const d=(0,o.h)("a",Object.assign({},s),...u);if(i===!0&&!(typeof window<"u"&&window.document)){const g=(0,o.h)("link",{rel:"prefetch",href:this.props.href,as:"document"}),p=(0,o.h)(l.Helmet,null,g);return(0,o.h)(a.Fragment,null,[p,d])}else return d}}return U.Link=r,U}var K={},Me;function ft(){return Me||(Me=1,(function(e){var t=K&&K.__rest||function(h,m){var S={};for(var _ in h)Object.prototype.hasOwnProperty.call(h,_)&&m.indexOf(_)<0&&(S[_]=h[_]);if(h!=null&&typeof Object.getOwnPropertySymbols=="function")for(var v=0,_=Object.getOwnPropertySymbols(h);v<_.length;v++)m.indexOf(_[v])<0&&Object.prototype.propertyIsEnumerable.call(h,_[v])&&(S[_[v]]=h[_[v]]);return S};Object.defineProperty(e,"__esModule",{value:!0}),e.parseParamsFromPath=e.Listener=e.Link=e.to=e.Route=e.Routes=e.Switch=e.matchPath=void 0;const l=$(),o=T(),a=[],r=h=>a.push(h),c=h=>a.splice(a.indexOf(h),1),n=h=>{window.history.pushState({},"",h),a.forEach(m=>m.handleChanges()),window.dispatchEvent(new Event("pushstate"))},u=h=>{window.history.replaceState({},"",h),a.forEach(m=>m.handleChanges()),window.dispatchEvent(new Event("replacestate"))},i=(h,m)=>{const{exact:S=!1,regex:_}=m;let{path:v}=m;if(!v)return{path:null,url:h,isExact:!0,params:{}};let w,j={};if(v.includes("/:")){const M=v.split("/"),O=h.split("/");M.forEach((x,fe)=>{if(/^:/.test(x)){const pe=x.slice(1),Xe=O[fe];if(_&&_[pe]&&!_[pe].test(Xe))return null;j=Object.assign(Object.assign({},j),{[pe]:Xe}),M[fe]=O[fe]}}),v=M.join("/")}if(v==="*"&&(w=[h]),w||(w=new RegExp(`^${v}`).exec(h)),!w)return null;const R=w[0],L=h===R;return S&&!L?null:{path:v,url:R,isExact:L,params:j}};e.matchPath=i;class f extends l.Component{constructor(){super(...arguments),this.index=0,this.path="",this.match={index:-1,path:""}}didMount(){window.addEventListener("popstate",this.handleChanges.bind(this)),r(this)}didUnmount(){window.removeEventListener("popstate",this.handleChanges.bind(this)),c(this)}handleChanges(){this.findChild(),this.shouldUpdate()&&this.update()}findChild(){this.match={index:-1,path:""},this.props.children=this.props.children.flat();for(let m=0;m<this.props.children.length;m++){const S=this.props.children[m],{path:_,exact:v,regex:w}=S.props;if((0,e.matchPath)((0,o.isSSR)()?_nano.location.pathname:window.location.pathname,{path:_,exact:v,regex:w})){this.match.index=m,this.match.path=_;return}}}shouldUpdate(){return this.path!==this.match.path||this.index!==this.match.index}render(){this.findChild();const m=this.props.children[this.match.index];if(this.match.index===-1&&(this.path="",this.index=0),m){const{path:S}=m.props;this.path=S,this.index=this.match.index;const _=(0,o._render)(m);return(0,o.h)("div",{},(0,o._render)(_))}else return this.props.fallback?(0,o.h)("div",{},(0,o._render)(this.props.fallback)):(0,o.h)("div",{},"not found")}}e.Switch=f;class y extends f{}e.Routes=y;const s=({path:h,regex:m,children:S})=>{const _=(0,o.isSSR)()?_nano.location.pathname:window.location.pathname,v=(0,e.parseParamsFromPath)(h);return S.forEach(w=>{w.props&&(w.props=Object.assign(Object.assign({},w.props),{route:{path:h,regex:m,pathname:_,params:v}}))}),S};e.Route=s;const d=(h,m=!1)=>{m?u(h):n(h)};e.to=d;const g=h=>{var{to:m,replace:S,children:_}=h,v=t(h,["to","replace","children"]);const w=j=>{j.preventDefault(),S?u(m):n(m)};return(0,o.h)("a",Object.assign({href:m,onClick:j=>w(j)},v),_)};e.Link=g;class p{constructor(){if(this._listeners=new Map,(0,o.isSSR)())return;this._route=window.location.pathname;const m=()=>{const S=window.location.pathname;this._listeners.forEach(_=>{_(S,this._route)}),this._route=S};window.addEventListener("pushstate",m),window.addEventListener("replacestate",m)}use(){const m=Math.random().toString(36).substring(2);return{subscribe:S=>{this._listeners.set(m,S)},cancel:()=>{this._listeners.has(m)&&this._listeners.delete(m)}}}}let b;const E=()=>(b||(b=new p),b);e.Listener=E;const P=h=>{let m={};const S=(0,o.isSSR)()?_nano.location.pathname.split("/"):window.location.pathname.split("/");return h.split("/").forEach((_,v)=>{_.startsWith(":")&&(m=Object.assign(Object.assign({},m),{[_.slice(1)]:S[v]}))}),m};e.parseParamsFromPath=P})(K)),K}var I={},Le;function pt(){if(Le)return I;Le=1;var e=I&&I.__awaiter||function(r,c,n,u){function i(f){return f instanceof n?f:new n(function(y){y(f)})}return new(n||(n=Promise))(function(f,y){function s(p){try{g(u.next(p))}catch(b){y(b)}}function d(p){try{g(u.throw(p))}catch(b){y(b)}}function g(p){p.done?f(p.value):i(p.value).then(s,d)}g((u=u.apply(r,c||[])).next())})},t=I&&I.__rest||function(r,c){var n={};for(var u in r)Object.prototype.hasOwnProperty.call(r,u)&&c.indexOf(u)<0&&(n[u]=r[u]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,u=Object.getOwnPropertySymbols(r);i<u.length;i++)c.indexOf(u[i])<0&&Object.prototype.propertyIsEnumerable.call(r,u[i])&&(n[u[i]]=r[u[i]]);return n};Object.defineProperty(I,"__esModule",{value:!0}),I.Suspense=void 0;const l=$(),o=T();class a extends l.Component{constructor(c){super(c),this.ready=!1;const n=this.props,{children:u,fallback:i,cache:f=!1}=n,y=t(n,["children","fallback","cache"]),s=JSON.stringify(y,function(d,g){return typeof g=="function"?`${g}`:g});this.id=(0,o.strToHash)(JSON.stringify(s))}didMount(){return e(this,void 0,void 0,function*(){const c=this.props,{children:n,fallback:u,cache:i=!1}=c,f=t(c,["children","fallback","cache"]);if(i&&(this.initState={}),this.loadFromCache(i))return;const y=Object.values(f).map(g=>g()),s=yield Promise.all(y),d=this.prepareData(f,s,i);this.addDataToChildren(d),this.ready=!0,this.update()})}ssr(){const c=this.props,{children:n,fallback:u,cache:i=!1}=c,f=t(c,["children","fallback","cache"]),y=Object.values(f).map(d=>d()),s=this.prepareData(f,y,!1);this.addDataToChildren(s)}loadFromCache(c){const n=this.state&&c&&Object.keys(this.state).length>0;return n&&(this.addDataToChildren(this.state),this.ready=!0),n}prepareData(c,n,u){return Object.keys(c).reduce((f,y,s)=>(u&&(this.state=Object.assign(Object.assign({},this.state),{[y]:n[s]})),Object.assign(Object.assign({},f),{[y]:n[s]})),{})}addDataToChildren(c){this.props.children.forEach(n=>{n.props&&(n.props=Object.assign(Object.assign({},n.props),c))})}render(){if((0,o.isSSR)())return this.ssr(),this.props.children;{const{cache:c=!1}=this.props;return this.loadFromCache(c),this.ready?this.props.children:this.props.fallback}}}return I.Suspense=a,I}var Q={},Te;function Ae(){if(Te)return Q;Te=1,Object.defineProperty(Q,"__esModule",{value:!0}),Q.Visible=void 0;const e=T(),t=$();class l extends t.Component{constructor(){super(...arguments),this.isVisible=!1}didMount(){new IntersectionObserver((r,c)=>{r.forEach(n=>{n.isIntersecting&&(c.disconnect(),this.isVisible=!0,this.update())})},{threshold:[0,1]}).observe(this.elements[0])}render(){return this.isVisible?(this.props.onVisible&&this.props.onVisible(),(0,e.render)(this.props.component||this.props.children[0])):(0,e.h)("div",{"data-visible":!1,visibility:"hidden"})}}return Q.Visible=l,Q}var qe;function mt(){return qe||(qe=1,(function(e){var t=k&&k.__createBinding||(Object.create?(function(i,f,y,s){s===void 0&&(s=y);var d=Object.getOwnPropertyDescriptor(f,y);(!d||("get"in d?!f.__esModule:d.writable||d.configurable))&&(d={enumerable:!0,get:function(){return f[y]}}),Object.defineProperty(i,s,d)}):(function(i,f,y,s){s===void 0&&(s=y),i[s]=f[y]})),l=k&&k.__setModuleDefault||(Object.create?(function(i,f){Object.defineProperty(i,"default",{enumerable:!0,value:f})}):function(i,f){i.default=f}),o=k&&k.__importStar||function(i){if(i&&i.__esModule)return i;var f={};if(i!=null)for(var y in i)y!=="default"&&Object.prototype.hasOwnProperty.call(i,y)&&t(f,i,y);return l(f,i),f};Object.defineProperty(e,"__esModule",{value:!0}),e.Visible=e.Suspense=e.Router=e.Link=e.Img=e.Helmet=void 0;var a=ce();Object.defineProperty(e,"Helmet",{enumerable:!0,get:function(){return a.Helmet}});var r=dt();Object.defineProperty(e,"Img",{enumerable:!0,get:function(){return r.Img}});var c=ht();Object.defineProperty(e,"Link",{enumerable:!0,get:function(){return c.Link}}),e.Router=o(ft());var n=pt();Object.defineProperty(e,"Suspense",{enumerable:!0,get:function(){return n.Suspense}});var u=Ae();Object.defineProperty(e,"Visible",{enumerable:!0,get:function(){return u.Visible}})})(k)),k}var de={},H={},ke;function _t(){if(ke)return H;ke=1,Object.defineProperty(H,"__esModule",{value:!0}),H.documentSSR=H.DocumentSSR=H.HTMLElementSSR=void 0;const e=Z();class t{constructor(r){this.isSelfClosing=!1,this.nodeType=null,this.tagName=r;const c=["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"];this.nodeType=1,c.indexOf(r)>=0?(this._ssr=`<${r} />`,this.isSelfClosing=!0):this._ssr=`<${r}></${r}>`}get outerHTML(){return this.toString()}get innerHTML(){return this.innerText}set innerHTML(r){this.innerText=r}get innerText(){var r;return((r=/(^<[^>]+>)(.+)?(<\/[a-z0-9]+>$|\/>$)/gm.exec(this._ssr))===null||r===void 0?void 0:r[2])||""}set innerText(r){const c=/(^<[^>]+>)(.+)?(<\/[a-z0-9]+>$|\/>$)/gm,n=(u,i,f,y)=>[i,r,y].join("");this._ssr=this._ssr.replace(c,n)}getAttribute(r){return null}get classList(){const r=this._ssr,c=/^<\w+.+(\sclass=")([^"]+)"/gm;return{add:n=>{this.setAttribute("class",n)},entries:{get length(){const n=c.exec(r);return n&&n[2]?n[2].split(" ").length:0}}}}toString(){return this._ssr}setAttributeNS(r,c,n){this.setAttribute(c,n)}setAttribute(r,c){const n=(i,f,y)=>`${f}${(0,e.escapeHtml)(r)}="${(0,e.escapeHtml)(c)}" ${y}`,u=(i,f,y)=>`${f} ${(0,e.escapeHtml)(r)}="${(0,e.escapeHtml)(c)}"${y}`;this.isSelfClosing?this._ssr=this._ssr.replace(/(^<[a-z0-9]+ )(.+)/gm,n):this._ssr=this._ssr.replace(/(^<[^>]+)(.+)/gm,u)}append(r){this.appendChild(r)}appendChild(r){const c=this._ssr.lastIndexOf("</");this._ssr=this._ssr.substring(0,c)+r+this._ssr.substring(c)}get children(){const r=/<([a-z0-9]+)((?!<\/\1).)*<\/\1>/gms,c=[];let n;for(;(n=r.exec(this.innerHTML))!==null;)c.push(n[0].replace(/[\s]+/gm," "));return c}addEventListener(r,c,n){}}H.HTMLElementSSR=t;class l{constructor(){this.body=this.createElement("body"),this.head=this.createElement("head")}createElement(r){return new t(r)}createElementNS(r,c){return this.createElement(c)}createTextNode(r){return(0,e.escapeHtml)(r)}querySelector(r){}}H.DocumentSSR=l;const o=()=>new l;return H.documentSSR=o,H}var Ie;function He(){return Ie||(Ie=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.clearState=e.renderSSR=e.initSSR=void 0;const t=T(),l=_t(),o=Oe(),a=Z(),r={isWebComponent:f=>typeof f=="string"&&f.includes("-")&&_nano.customElements.has(f),renderWebComponent:(f,y,s,d)=>{const g=_nano.customElements.get(f),b=d({component:g,props:Object.assign(Object.assign({},y),{children:s})}).toString().match(/^<(?<tag>[a-z]+)>(.*)<\/\k<tag>>$/);if(b){let P=function(h,m,S,_){return h.replace(m,"")};const E=document.createElement(b[1]);return E.innerText=b[2],E.innerText=E.innerText.replace(/<\w+[^>]*(\s(on\w*)="[^"]*")/gm,P),E}else return null}};(()=>{const f=(0,a.detectSSR)()===!0?!0:void 0,y={pathname:"/"},s=f?(0,l.documentSSR)():window.document;globalThis._nano={isSSR:f,location:y,document:s,customElements:new Map,ssrTricks:r}})();const n=(f="/")=>{_nano.location={pathname:f},globalThis.document=_nano.document=(0,t.isSSR)()?(0,l.documentSSR)():window.document};e.initSSR=n;const u=(f,y={})=>{const{pathname:s,clearState:d=!0}=y;(0,e.initSSR)(s),d&&o._state.clear();const g=(0,t.render)(f,null,!0);return Array.isArray(g)?g.join(""):Array.from(g).join("")};e.renderSSR=u;const i=()=>{o._state.clear()};e.clearState=i})(de)),de}var z={},J={},ie={},ee={},Ne;function $e(){return Ne||(Ne=1,Object.defineProperty(ee,"__esModule",{value:!0}),ee.MINI=void 0,ee.MINI=!1),ee}var he={},De;function gt(){return De||(De=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.build=e.evaluate=e.treeify=void 0;const t=$e(),l=0,o=1,a=2,r=3,c=4,n=5,u=6,i=0,f=2,y=3,s=4,d=n,g=u,p=(P,h)=>{const m=_=>{let v="",w=null;const j=[],R=[];for(let L=1;L<_.length;L++){const M=_[L++],O=_[L]?h[_[L++]-1]:_[++L];M===y?v=O:M===s?(j.push(O),w=null):M===d?(w||(w=Object.create(null),j.push(w)),w[_[++L]]=[O]):M===g?w[_[++L]].push(O):M===f?R.push(m(O)):M===i&&R.push(O)}return{tag:v,props:j,children:R}},{children:S}=m(P);return S.length>1?S:S[0]};e.treeify=p;const b=(P,h,m,S)=>{let _;h[0]=0;for(let v=1;v<h.length;v++){const w=h[v++],j=h[v]?(h[0]|=w?1:2,m[h[v++]]):h[++v];w===y?S[0]=j:w===s?S[1]=Object.assign(S[1]||{},j):w===d?(S[1]=S[1]||{})[h[++v]]=j:w===g?S[1][h[++v]]+=`${j}`:w?(_=P.apply(j,(0,e.evaluate)(P,j,m,["",null])),S.push(_),j[0]?h[0]|=2:(h[v-2]=i,h[v]=_)):S.push(j)}return S};e.evaluate=b;const E=function(P,...h){const m=[P,...h],S=this;let _=o,v="",w="",j=[0],R,L;const M=O=>{_===o&&(O||(v=v.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?t.MINI?j.push(O?m[O]:v):j.push(i,O,v):_===r&&(O||v)?(t.MINI?j[1]=O?m[O]:v:j.push(y,O,v),_=a):_===a&&v==="..."&&O?t.MINI?j[2]=Object.assign(j[2]||{},m[O]):j.push(s,O,0):_===a&&v&&!O?t.MINI?(j[2]=j[2]||{})[v]=!0:j.push(d,0,!0,v):_>=n&&(t.MINI?_===n?((j[2]=j[2]||{})[L]=O?v?v+m[O]:m[O]:v,_=u):(O||v)&&(j[2][L]+=O?v+m[O]:v):((v||!O&&_===n)&&(j.push(_,0,v,L),_=u),O&&(j.push(_,O,0,L),_=u))),v=""};for(let O=0;O<P.length;O++){O&&(_===o&&M(),M(O));for(let x=0;x<P[O].length;x++)R=P[O][x],_===o?R==="<"?(M(),t.MINI?j=[j,"",null]:j=[j],_=r):v+=R:_===c?v==="--"&&R===">"?(_=o,v=""):v=R+v[0]:w?R===w?w="":v+=R:R==='"'||R==="'"?w=R:R===">"?(M(),_=o):_&&(R==="="?(_=n,L=v,v=""):R==="/"&&(_<n||P[O][x+1]===">")?(M(),_===r&&(j=j[0]),_=j,t.MINI?(j=j[0]).push(S(..._.slice(1))):(j=j[0]).push(f,0,_),_=l):R===" "||R==="	"||R===`
`||R==="\r"?(M(),_=a):v+=R),_===r&&v==="!--"&&(_=c,j=j[0])}return M(),t.MINI?j.length>2?j.slice(1):j[1]:j};e.build=E})(he)),he}var Ve;function yt(){if(Ve)return ie;Ve=1,Object.defineProperty(ie,"__esModule",{value:!0});const e=$e(),t=gt(),l=new Map,o=function(a){let r=l.get(this);return r||(r=new Map,l.set(this,r)),r=(0,t.evaluate)(this,r.get(a)||(r.set(a,r=(0,t.build)(a)),r),arguments,[]),r.length>1?r:r[0]};return ie.default=e.MINI?t.build:o,ie}var Ue;function bt(){if(Ue)return J;Ue=1;var e=J&&J.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(J,"__esModule",{value:!0});const t=e(yt());return J.default=t.default,J}var ze;function vt(){if(ze)return z;ze=1;var e=z&&z.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(z,"__esModule",{value:!0}),z.jsx=void 0;const t=T(),o=e(bt()).default.bind(t.h);return z.jsx=o,z}var te={},Be;function St(){if(Be)return te;Be=1,Object.defineProperty(te,"__esModule",{value:!0}),te.hydrateLazy=void 0;const e=T(),t=Ae(),l=(o,a=null,r=!0)=>{const c=(0,e.h)(t.Visible,null,o);return(0,e.hydrate)(c,a,r)};return te.hydrateLazy=l,te}var ne={},Fe;function jt(){if(Fe)return ne;Fe=1,Object.defineProperty(ne,"__esModule",{value:!0}),ne.Store=void 0;const e=T();class t{constructor(o,a="",r="memory"){if(this._listeners=new Map,(0,e.isSSR)()&&(r="memory"),this._id=a,this._storage=r,this._state=this._prevState=o,r==="memory"||!r)return;const c=r==="local"?localStorage:sessionStorage,n=c.getItem(this._id);n?this._state=this._prevState=JSON.parse(n):c.setItem(this._id,JSON.stringify(o))}persist(o){if(this._storage==="memory")return;(this._storage==="local"?localStorage:sessionStorage).setItem(this._id,JSON.stringify(o))}clear(){this._state=this._prevState=void 0,this._storage==="local"?localStorage.removeItem(this._id):this._storage==="session"&&sessionStorage.removeItem(this._id)}setState(o){this.state=o}set state(o){this._prevState=this._state,this._state=o,this.persist(o),this._listeners.forEach(a=>{a(this._state,this._prevState)})}get state(){return this._state}use(){const o=Math.random().toString(36).substring(2,9),a=this;return{get state(){return a.state},setState:r=>{this.state=r},subscribe:r=>{this._listeners.set(o,r)},cancel:()=>{this._listeners.has(o)&&this._listeners.delete(o)}}}}return ne.Store=t,ne}var B={},xe;function Ot(){if(xe)return B;xe=1,Object.defineProperty(B,"__esModule",{value:!0}),B.useContext=B.createContext=void 0;const e=l=>{let o=l;return{Provider:a=>(a.value&&(o=a.value),a.children),Consumer:a=>({component:a.children[0](o),props:Object.assign(Object.assign({},a),{context:o})}),get:()=>o,set:a=>o=a}};B.createContext=e;const t=l=>{const o=l;if(o&&typeof o.get=="function")return o.get()};return B.useContext=t,B}var F={},Je;function wt(){if(Je)return F;Je=1;var e=F&&F.__rest||function(c,n){var u={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&n.indexOf(i)<0&&(u[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,i=Object.getOwnPropertySymbols(c);f<i.length;f++)n.indexOf(i[f])<0&&Object.prototype.propertyIsEnumerable.call(c,i[f])&&(u[i[f]]=c[i[f]]);return u};Object.defineProperty(F,"__esModule",{value:!0}),F.withStyles=void 0;const t=T(),l=$(),o=ue(),a=ce(),r=(...c)=>n=>class extends l.Component{render(){const u=this.props,{children:i}=u,f=e(u,["children"]),y=[];c.forEach(d=>{var g;if(typeof d=="string")y.push((0,t.h)(a.Helmet,null,(0,t.h)("style",null,d)));else if(typeof d=="function"){const p=d();typeof p=="string"&&y.push((0,t.h)(a.Helmet,null,(0,t.h)("style",null,p)))}else if(typeof d=="object"){const p=(g=d.toString)===null||g===void 0?void 0:g.call(d);typeof p=="string"&&y.push((0,t.h)(a.Helmet,null,(0,t.h)("style",null,p)))}});const s=i&&i.length>0?(0,t.h)(n,Object.assign({},f),i):(0,t.h)(n,Object.assign({},this.props));return(0,t.h)(o.Fragment,null,...y,s)}};return F.withStyles=r,F}var re={},We;function Pt(){if(We)return re;We=1,Object.defineProperty(re,"__esModule",{value:!0}),re.defineAsCustomElements=void 0;const e=T(),t=(o,a,r=[],c={})=>{/^[a-zA-Z0-9]+-[a-zA-Z0-9]+$/.test(a)?_nano.customElements.set(a,o):console.log(`Error: WebComponent name "${a}" is invalid.`)},l=function(o,a,r,c){if((0,e.isSSR)()){t(o,a,r);return}customElements.define(a,class extends HTMLElement{constructor(){super(),c?(this.attachShadow(c),this.$root=this.shadowRoot):this.$root=this;let n;const u=this.buildEl((0,e._render)({component:o,props:{ref:i=>n=i,children:Array.from(this.children).map(i=>(0,e.render)(i))}}));this.component=n,this.isFunctionalComponent=!o.isClass,this.functionalComponentsProps={},this.appendEl(u),this.isFunctionalComponent||(this.component.updatePropsValue=(i,f)=>{this.component.props||(this.component.props={}),this.component.props[i]=f,this.component[i]=f})}static get observedAttributes(){return r}buildEl(n){return(0,e.h)(this.shadowRoot?"div":"template",null,n)}appendEl(n){this.shadowRoot?this.$root.append(n):this.$root.append(...n.childNodes)}removeChildren(){var n;if(this.$root){const u=Array.from((n=this.$root)===null||n===void 0?void 0:n.children)||[];for(const i of u)i.remove()}}attributeChangedCallback(n,u,i){if(!this.isFunctionalComponent)this.component.updatePropsValue(n,i),this.component.update();else{this.removeChildren(),this.functionalComponentsProps[n]=i;const f=this.buildEl((0,e._render)({component:o,props:Object.assign({children:[],ref:y=>this.component=y},this.functionalComponentsProps)}));this.appendEl(f)}}})};return re.defineAsCustomElements=l,re}var Ge;function Ct(){return Ge||(Ge=1,(function(e){var t=D&&D.__createBinding||(Object.create?(function(P,h,m,S){S===void 0&&(S=m);var _=Object.getOwnPropertyDescriptor(h,m);(!_||("get"in _?!h.__esModule:_.writable||_.configurable))&&(_={enumerable:!0,get:function(){return h[m]}}),Object.defineProperty(P,S,_)}):(function(P,h,m,S){S===void 0&&(S=m),P[S]=h[m]})),l=D&&D.__exportStar||function(P,h){for(var m in P)m!=="default"&&!Object.prototype.hasOwnProperty.call(h,m)&&t(h,P,m)};Object.defineProperty(e,"__esModule",{value:!0}),e.VERSION=e.printVersion=e.defineAsCustomElements=e.withStyles=e.useContext=e.createContext=e.Store=e.Fragment=e.renderSSR=e.task=e.nodeToString=e.hydrateLazy=e.jsx=e.isSSR=e.Component=e.tick=e.hydrate=e.render=e.h=void 0;var o=T();Object.defineProperty(e,"h",{enumerable:!0,get:function(){return o.h}}),Object.defineProperty(e,"render",{enumerable:!0,get:function(){return o.render}}),Object.defineProperty(e,"hydrate",{enumerable:!0,get:function(){return o.hydrate}}),Object.defineProperty(e,"tick",{enumerable:!0,get:function(){return o.tick}});var a=$();Object.defineProperty(e,"Component",{enumerable:!0,get:function(){return a.Component}}),l(mt(),e);const r=T();Object.defineProperty(e,"isSSR",{enumerable:!0,get:function(){return r.isSSR}});const c=He();e.default={h:r.h,render:r.render,hydrate:r.hydrate,renderSSR:c.renderSSR,isSSR:r.isSSR};var n=vt();Object.defineProperty(e,"jsx",{enumerable:!0,get:function(){return n.jsx}});var u=St();Object.defineProperty(e,"hydrateLazy",{enumerable:!0,get:function(){return u.hydrateLazy}});var i=Z();Object.defineProperty(e,"nodeToString",{enumerable:!0,get:function(){return i.nodeToString}}),Object.defineProperty(e,"task",{enumerable:!0,get:function(){return i.task}});var f=He();Object.defineProperty(e,"renderSSR",{enumerable:!0,get:function(){return f.renderSSR}});var y=ue();Object.defineProperty(e,"Fragment",{enumerable:!0,get:function(){return y.Fragment}});var s=jt();Object.defineProperty(e,"Store",{enumerable:!0,get:function(){return s.Store}});var d=Ot();Object.defineProperty(e,"createContext",{enumerable:!0,get:function(){return d.createContext}}),Object.defineProperty(e,"useContext",{enumerable:!0,get:function(){return d.useContext}});var g=wt();Object.defineProperty(e,"withStyles",{enumerable:!0,get:function(){return g.withStyles}});var p=Pt();Object.defineProperty(e,"defineAsCustomElements",{enumerable:!0,get:function(){return p.defineAsCustomElements}});var b=Z();Object.defineProperty(e,"printVersion",{enumerable:!0,get:function(){return b.printVersion}});var E=ve();Object.defineProperty(e,"VERSION",{enumerable:!0,get:function(){return E.VERSION}})})(D)),D}var oe=Ct();const Ze=ut(oe);class Rt extends oe.Component{render(){return C("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px 16px",marginBottom:"12px",borderRadius:"8px",backgroundColor:"var(--color-neutral-background)",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:C("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[this.props.icon&&C("span",{style:{fontSize:"20px"},children:this.props.icon}),C("div",{children:[C("div",{style:{fontWeight:600,fontSize:"14px",marginBottom:"4px"},children:this.props.title}),C("div",{style:{fontSize:"12px",color:"var(--color-neutral-text)",opacity:.8},children:this.props.description})]})]})})}}class Et extends oe.Component{render(){const{visible:t,onClose:l,items:o}=this.props;return C("div",{style:{display:t?"flex":"none",position:"fixed",top:0,left:0,width:"100%",height:"100%",alignItems:"center",justifyContent:"center",background:"rgba(0,0,0,0.5)",zIndex:9999},children:C("div",{style:{background:"var(--color-neutral-background)",padding:"20px",borderRadius:"8px",position:"relative",color:"var(--color-neutral-content-strong)",height:"85%",width:"85%"},children:[C("span",{style:{position:"absolute",top:"5px",right:"10px",cursor:"pointer",fontWeight:"bold"},onClick:l,children:"×"}),C("h2",{children:"ReadIt Settings"}),C("div",{id:"settings-tile-container",children:o.map(a=>C(Rt,{title:a.title,description:a.description}))})]})})}}class Mt extends oe.Component{render(){const{onClick:t}=this.props;return C("span",{"data-part":"create",class:"contents",children:C("create-post-entry-point-wrapper",{children:C("faceplate-tracker",{class:"nd:visible contents",source:"post_composer",action:"click",noun:"create_post",children:C("rpl-tooltip",{style:"--rpl-z-index-tooltip:1001",class:"nd:visible contents",placement:"bottom",appearance:"inverted",trigger:"hover focus-visible",distance:"8",children:[C("a",{rpl:"","aria-label":"ReadIt Settings",class:`no-underline hover:no-underline active:no-underline
                        button-medium px-[var(--rem8)]
                        button-plain icon items-center justify-center
                        button inline-flex`,id:"settings-open",onClick:t,children:[C("span",{class:"flex items-center justify-center",children:C("span",{class:"flex",children:C("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"#e3e3e3",children:C("path",{d:"m370-80-16-128q-13-5-24.5-12T307-235l-119 50L78-375l103-78q-1-7-1-13.5v-27q0-6.5 1-13.5L78-585l110-190 119 50q11-8 23-15t24-12l16-128h220l16 128q13 5 24.5 12t22.5 15l119-50 110 190-103 78q1 7 1 13.5v27q0 6.5-2 13.5l103 78-110 190-118-50q-11 8-23 15t-24 12L590-80H370Zm70-80h79l14-106q31-8 57.5-23.5T639-327l99 41 39-68-86-65q5-14 7-29.5t2-31.5q0-16-2-31.5t-7-29.5l86-65-39-68-99 42q-22-23-48.5-38.5T533-694l-13-106h-79l-14 106q-31 8-57.5 23.5T321-633l-99-41-39 68 86 64q-5 15-7 30t-2 32q0 16 2 31t7 30l-86 65 39 68 99-42q22 23 48.5 38.5T427-266l13 106Zm42-180q58 0 99-41t41-99q0-58-41-99t-99-41q-59 0-99.5 41T342-480q0 58 40.5 99t99.5 41Zm-2-140Z"})})})}),C("faceplate-screen-reader-content",{children:"ReadIt Settings"})]}),C("span",{slot:"content",children:"ReadIt Settings"})]})})})})}}class Lt{constructor(t){this.readit=t,this.visible=!1,this.tiles=[],this.isSettingsVisible=()=>document.getElementById("settings-open")!==null,this.open=()=>{this.visible=!0,this.render()},this.close=()=>{this.visible=!1,this.render()},this.toggle=()=>{this.visible=!this.visible,this.render()},this.modalContainer=document.createElement("div"),document.body.appendChild(this.modalContainer),this.injectButton(),this.patchRenderMethod(),this.render()}injectButton(){const t=document.querySelector("body > shreddit-app > reddit-header-large > reddit-header-action-items > header > nav > div.ps-lg.gap-xs.flex.items-center.justify-end > div:nth-child(2)");if(!t||this.isSettingsVisible())return;const l=document.createElement("div");t.appendChild(l),Ze.render(C(Mt,{onClick:this.open}),l)}patchRenderMethod(){const t=document.querySelector("shreddit-app");if(!t)return;const l=t.__proto__;if(l.__readitPatched)return;const o=l.render;l.render=function(...a){const r=o.call(this,...a);return this.readit?.settings?.injectButton?.(),r},l.__readitPatched=!0}registerSettingsTile(t){this.tiles.push(t),this.render()}render(){Ze.render(C(Et,{visible:this.visible,onClose:this.close,items:this.tiles}),this.modalContainer)}}class Tt{constructor(){this.version=GM_info.script.version,this.posts=new Ye(this),this.settings=new Lt(this),this.plugins=new rt(this),this.plugins.loadPlugins(),this.settings.registerSettingsTile({title:"ReadIt Version",description:this.version})}}const At=new Tt;unsafeWindow.readit=At})();
